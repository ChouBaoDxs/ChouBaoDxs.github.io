(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{941:function(s,t,a){"use strict";a.r(t);var n=a(12),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"title"}),a("p",[s._v("视频名称：Django2.0 教程"),a("br"),s._v("\n视频地址：https://space.bilibili.com/252028233/"),a("br"),s._v("\n作者博客网址：http://yshblog.com"),a("br"),s._v("\n源代码和课件：https://github.com/HaddyYang/django2.0-course"),a("br"),s._v("\n最新一集：https://www.bilibili.com/video/av32351872")])]),s._v(" "),a("p",[s._v("[TOC]")]),s._v(" "),a("h2",{attrs:{id:"_01-什么是-django"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_01-什么是-django"}},[s._v("#")]),s._v(" 01.什么是 Django")]),s._v(" "),a("p",[s._v("django 官网：https://www.djangoproject.com\n我墙裂推荐 django rest framwork：http://www.django-rest-framework.org")]),s._v(" "),a("h3",{attrs:{id:"来自官网的三句话"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#来自官网的三句话"}},[s._v("#")]),s._v(" 来自官网的三句话")]),s._v(" "),a("ul",[a("li",[s._v("The web framework for perfectionists with deadlines.——在(项目)截止日期内，完美主义者使用的 Web 框架。")]),s._v(" "),a("li",[s._v("Django makes it easier to build better Web apps more quickly and with less code.——Django 使通过少量的代码和更快的速度构建好一个 Web 应用变得简单。")]),s._v(" "),a("li",[s._v("Django was invented to meet fast-moving newsroom deadlines, while satisfying the tough requirements of experienced Web developers.——Django 的发明是为了满足快速变化的新闻编辑室的最后期限，同时满足有经验的 Web 开发人员的严格要求。")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("特性")]),s._v(" "),a("th",{staticStyle:{"text-align":"left"}},[s._v("突出点")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("鼓励快速开发"),a("br"),s._v("简介实用的设计"),a("br"),s._v("处理了很多 Web 开发琐事"),a("br"),s._v("令使用者专注实现"),a("br"),s._v("无需重复造轮子"),a("br"),s._v("免费并开源"),a("br")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("开发快到离谱"),a("br"),s._v("令人放心的安全"),a("br"),s._v("可扩展性强")])])])]),s._v(" "),a("p",[s._v("Django 版本更迭：\n"),a("img",{attrs:{src:"https://www.djangoproject.com/s/img/release-roadmap.e844db08610e.png",alt:"Django版本更迭"}})]),s._v(" "),a("p",[s._v("Django 和 Python")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("Django version")]),s._v(" "),a("th",{staticStyle:{"text-align":"left"}},[s._v("Python versions")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("1.11")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("2.7, 3.4, 3.5, 3.6")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("2.0")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("3.4, 3.5, 3.6, 3.7")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("2.1, 2.2")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("3.5, 3.6, 3.7")])])])]),s._v(" "),a("p",[s._v("下载并安装 Python：https://www.python.org/\n注意：这里我使用了 virtualenv：mkvirtualenv Django2.0Tutorial -p python3\n安装 Django：pip install Django==2.0")]),s._v(" "),a("h2",{attrs:{id:"_02-入门仪式-hello-world"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_02-入门仪式-hello-world"}},[s._v("#")]),s._v(" 02.入门仪式：Hello World")]),s._v(" "),a("p",[a("code",[s._v("hello,world")]),s._v("源自 Brian Kernighan 和 Dennis M. Ritchie(C 语言之父)合著的《The C Programme Language》中使用而广泛流行。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('print("hello,world\\n")\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("入门仪式：创建项目，输出 Hello,world\n创建项目命令：django-admin startproject <项目名>\neg：django-admin startproject mysite")]),s._v(" "),a("p",[s._v("响应请求：客户端——>urls——>Views")]),s._v(" "),a("p",[s._v("启动 django 项目：命令行执行 python manage.py runserver <ip:port>\n关闭：ctrl+c")]),s._v(" "),a("p",[s._v("django2.0 和 django1.x 的第一个区别：django1.x 的路由方法 url(依然可用)被换成了 path 和 re_path，path 没有正则表达式，所以以下两个写法意思相同：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" views"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\nre_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'^$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" views"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("先初始化一下数据库(默认会生成并使用 sqlite 数据库)：python manage.py migrate\n创建超级管理员：python manage.py createsuperuser\n用户名：admin 邮箱(可以回车跳过)：110@qq.com 密码：admin123")]),s._v(" "),a("h2",{attrs:{id:"_03-django-基本应用结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_03-django-基本应用结构"}},[s._v("#")]),s._v(" 03.Django 基本应用结构")]),s._v(" "),a("p",[s._v("创建应用：python manage.py startapp <应用名称>\neg：python manage.py startapp article\n然后就在 models.py 里随便写了点东西")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Article")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    title "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CharField"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("max_length"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    content "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TextField"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("在 settings.py 的 INSTALLED_APPS 中注册这个 app：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'article'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'article.apps.ArticleConfig'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("生成数据库迁移文件：python manage.py makemigrations\n根据迁移文件改变数据库结构：python manage.py migrate")]),s._v(" "),a("p",[s._v("在 admin.py 中注册以便在http://127.0.0.1:8000/admin/能看到：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("contrib "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" admin\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("models "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Article\n\nadmin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("site"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Article"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("修改 settings.py 中的语言设置："),a("code",[s._v("LANGUAGE_CODE = 'zh-hans'")])]),s._v(" "),a("h2",{attrs:{id:"_04-使用模版显示内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_04-使用模版显示内容"}},[s._v("#")]),s._v(" 04.使用模版显示内容")]),s._v(" "),a("p",[s._v("如何通过一个处理方法获取：文章唯一标识")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<int:article_id>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" views"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("article_detail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"article_detail"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("数据库对象不存在的异常的处理(报 404)：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shortcuts "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" get_object_or_404\narticle "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" get_object_or_404"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Article"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pk"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("article_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("http "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Http404\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" Http404"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'文章不存在'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("settings.py 中 TEMPLATES 的有关设置：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("BACKEND：模板系统\nDIRS：模板文件夹\nAPP_DIRS：(True或False)表示app里的模板目录是否有效\n# 注：django中规定的模板目录名为templates\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("render 和 render_to_response：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shortcuts "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" render"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" render_to_response\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" render"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"article_detail.html"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" render_to_response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"article_detail.html"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("include 导入 app 里的 urls：")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("urls "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" include\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\npath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'article/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" include"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'article.urls'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"_05-定制后台和修改模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_05-定制后台和修改模型"}},[s._v("#")]),s._v(" 05.定制后台和修改模型")]),s._v(" "),a("p",[s._v("在 admin 中标注对象的特定信息(python2 是重写"),a("strong",[s._v("unicode")]),s._v(")：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Article")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    title "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CharField"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("max_length"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    content "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TextField"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("__str__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string-interpolation"}},[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"')]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"')])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("定制 admin：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Article"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第一种注册方式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArticleAdmin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ModelAdmin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    list_display "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'title'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'content'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    ordering "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 按id正序")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# ordering = ("-id",)   # 按id倒序')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# admin.site.register(Article, ArticleAdmin)    # 第二种注册方式")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("修改模型并同步到数据库：\n生成数据库迁移文件：python manage.py makemigrations\n根据迁移文件改变数据库结构：python manage.py migrate")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("db "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" models\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("utils "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" timezone\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("contrib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("auth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("models "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" User\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Article")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    title "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CharField"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("max_length"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    content "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("TextField"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# created_time = models.DateTimeField(default=timezone.now)")]),s._v("\n    created_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DateTimeField"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("auto_now_add"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# auto_now_add添加记录时添加时间")]),s._v("\n    last_updated_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DateTimeField"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("auto_now"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# auto_now修改记录时修改时间")]),s._v("\n    author "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ForeignKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" on_delete"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DO_NOTHING"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" default"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("__str__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string-interpolation"}},[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('f"')]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"')])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"_06-开始完整制作网站"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_06-开始完整制作网站"}},[s._v("#")]),s._v(" 06.开始完整制作网站")]),s._v(" "),a("ul",[a("li",[s._v("为什么要做网站：兴趣爱好，学习一门技术，业务需求，工作需要，创业——>动力影响学习热情、原因决定最终结果")]),s._v(" "),a("li",[s._v("如何用 Django 开发网站\n"),a("ol",[a("li",[s._v("要做什么")]),s._v(" "),a("li",[s._v("设计网站原型：业务流程、功能模块、前端布局、后端模型")]),s._v(" "),a("li",[s._v("具体开发")]),s._v(" "),a("li",[s._v("测试")]),s._v(" "),a("li",[s._v("部署上限")])])]),s._v(" "),a("li",[s._v("接下来的过程：\n"),a("ol",[a("li",[s._v("项目管理：IDE、本地虚拟环境、Git/GitHub")]),s._v(" "),a("li",[s._v("前端开发：html、js、css、jQuery、ajax、BootStrap")]),s._v(" "),a("li",[s._v("后端开发：博客管理和展示、用户登录和注册(第三方登录)、评论和回复、点赞")]),s._v(" "),a("li",[s._v("数据库和服务器：MySQL、Linux、网站部署")])])]),s._v(" "),a("li",[s._v("IDE：\n"),a("ol",[a("li",[s._v("记事本")]),s._v(" "),a("li",[s._v("vim/Emacs")]),s._v(" "),a("li",[s._v("Sublime Text")]),s._v(" "),a("li",[s._v("PyCharm")]),s._v(" "),a("li",[s._v("VS Code")])])])]),s._v(" "),a("h2",{attrs:{id:"_07-构建个人博客网站"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_07-构建个人博客网站"}},[s._v("#")]),s._v(" 07.构建个人博客网站")]),s._v(" "),a("ol",[a("li",[s._v("网站的功能模块(功能模块 ≈Django App)：")])]),s._v(" "),a("ul",[a("li",[s._v("博客：博文、分类、标签")]),s._v(" "),a("li",[s._v("评论")]),s._v(" "),a("li",[s._v("点赞")]),s._v(" "),a("li",[s._v("阅读")]),s._v(" "),a("li",[s._v("用户：第三方登录(QQ 和微博)")])]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[s._v("开启本地虚拟环境(virtualenv)：\n隔开 python 项目的运行环境 1)避免多个项目之间 python 库的冲突 2)完整便捷导出 python 库的列表")])]),s._v(" "),a("li",[a("p",[s._v("virtualenv 的使用方法：\n创建：virtualenv <虚拟环境名称>\n启动：cd 虚拟环境目录 & Script\\activate\n退出：deactivate")])]),s._v(" "),a("li",[a("p",[s._v("初步创建 blog 应用\n博文+博客分类：一篇博客一种/多种分类，up 说他觉得多对多不好管理很麻烦，建议选第一种，我觉得他可能没用好 models.ManyToManyField\n还是新建项目：django-admin startproject myblog\n创建 app：django-admin startapp blog\n数据库迁移：python manage.py migrate\n创建超级管理员：python manage.py createsuperuser\n用户名：admin 邮箱：直接回车 密码：admin123")])])]),s._v(" "),a("p",[s._v("我这里一开始就修改了 settings.py 里的时区和语言：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LANGUAGE_CODE = 'en-us'")]),s._v("\nLANGUAGE_CODE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zh-Hans'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TIME_ZONE = 'UTC'")]),s._v("\nTIME_ZONE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Asia/Shanghai'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# USE_TZ = True")]),s._v("\nUSE_TZ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("编写 blog 相关的 model 和 admin...")]),s._v(" "),a("p",[s._v("tips——开发过程中通过网站看效果的时候，使用浏览器的无痕模式最好，不用手动去清缓存和 cookie")]),s._v(" "),a("p",[s._v("tips——pip 一键导出和安装依赖库：\npip freeeze > requirements.txt\npip install -r requirements.txt")]),s._v(" "),a("h2",{attrs:{id:"_08-常用的模版标签和过滤器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_08-常用的模版标签和过滤器"}},[s._v("#")]),s._v(" 08.常用的模版标签和过滤器")]),s._v(" "),a("p",[s._v("写 html、view 和配 url")]),s._v(" "),a("p",[s._v("for 循环为空的处理：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" blog "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" blogs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" empty "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v("循环没有内容时会显示 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" endfor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"常用的模板标签"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用的模板标签"}},[s._v("#")]),s._v(" 常用的模板标签")]),s._v(" "),a("p",[s._v("循环：for\n条件：if、ifequal、ifnotequal\n链接：url\n模板嵌套：block、extends、include\n注释："),a("code",[s._v("{# #}")])]),s._v(" "),a("h3",{attrs:{id:"常用过滤器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用过滤器"}},[s._v("#")]),s._v(" 常用过滤器")]),s._v(" "),a("p",[s._v('长度：length\n格式化 DataTime 数据类型：date:"Y-m-d H:n:s"\n限制显示 30 个字符长度：truncatechars:30\n其他字数截取：truncatechars_html、truncatewords、truncatewords_html\n是否信任 html：safe\n官方文档：https://docs.djangoproject.com/en/2.1/ref/templates/builtins/')]),s._v(" "),a("h2",{attrs:{id:"_09-模版嵌套"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_09-模版嵌套"}},[s._v("#")]),s._v(" 09.模版嵌套")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("{% block content %}{% endblock %}\n{% extends 'base.html' %}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("全局模板文件夹：settings——>TEMPLATES——>DIRS")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过pycharm创建项目的话，可以选择生成这个")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DIRS'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("BASE_DIR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'templates'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"_10-使用-css-美化页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-使用-css-美化页面"}},[s._v("#")]),s._v(" 10.使用 CSS 美化页面")]),s._v(" "),a("p",[s._v("CSS(层叠样式表)：用于修饰 html 的语言")]),s._v(" "),a("p",[s._v("居中：")]),s._v(" "),a("div",{staticClass:"language-css line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[s._v('<style type="text/css">\n    h3.home-content')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("font-size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 222%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("position")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" absolute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("left")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 50%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("top")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 50%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("transform")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("translate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-50%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("-50%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n</style>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("静态文件：css 文件、js 文件、图片\nsettings.py 中配置：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[s._v("STATICFILES_DIRS "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("BASE_DIR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'static'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("html 文件中使用：")]),s._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[s._v('{% load staticfiles %} ... <link rel="stylesheet" href="{% static "css/base.css"\n%}">\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"_11-css-框架协助前端布局"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-css-框架协助前端布局"}},[s._v("#")]),s._v(" 11.CSS 框架协助前端布局")]),s._v(" "),a("ul",[a("li",[s._v("为什么用 CSS 框架\n"),a("ol",[a("li",[s._v("不会或不怎么会 CSS")]),s._v(" "),a("li",[s._v("不知道如何设计前端样式")]),s._v(" "),a("li",[s._v("从头到尾写整个网站的 CSS 代码量大")]),s._v(" "),a("li",[s._v("...")])])]),s._v(" "),a("li",[s._v("如何选择 CSS 框架\n易用性、兼容性、大小、效果、功能——>Bootstrap\nBootstrap：\n"),a("ol",[a("li",[s._v("文档齐全，使用简单")]),s._v(" "),a("li",[s._v("兼容较多浏览器")]),s._v(" "),a("li",[s._v("非轻量级")]),s._v(" "),a("li",[s._v("扁平，简洁")]),s._v(" "),a("li",[s._v("组件齐全、响应式")])])]),s._v(" "),a("li",[s._v("部署 Bootstrap 1. 打开 Bootstrap 官网：www.bootcss.com 2. 下载 Bootstrap 3. 引用 Bootstrap 4. 开始使用\n教程用的是 Bootstrap-3.3.7：https://v3.bootcss.com/getting-started/，不翻墙还很难下\n下载 jQuery：https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js\nBoostrap 栅格系统：https://v3.bootcss.com/css/#grid")])]),s._v(" "),a("p",[s._v("tips——编写 div.navbar 后按 tab 可以快速生成"),a("code",[s._v('<div class="navbar"></div>')]),s._v(",支持 div.navbar.navbar-default\ntips——li*2>a，按 tab 生成：")]),s._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("href")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("a")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("id 的话是#")]),s._v(" "),a("h2",{attrs:{id:"_12-bootstrap-响应式布局"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-bootstrap-响应式布局"}},[s._v("#")]),s._v(" 12.Bootstrap 响应式布局")]),s._v(" "),a("p",[s._v("Bootstrap 栅格参数：https://v3.bootcss.com/css/#grid-options\n适应 4 种屏幕大小(12 列布局)：\n手机：<768px\n平板：>=768px\n小尺寸显示器：>=992px\n大尺寸显示器：>=1200px")]),s._v(" "),a("p",[s._v("基本结构：")]),s._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("row"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("col-xx-*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("col-xx-*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v('Bootstrap 面板：https://v3.bootcss.com/components/#panels\n响应式工具(设置是否显示等)：https://v3.bootcss.com/css/#responsive-utilities\n例如：class="hidden-xs" 就表示超小屏幕不显示该元素\ncss 中：em 是字体大小单位')]),s._v(" "),a("div",{staticClass:"language-css line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[s._v("div.blog:not(:last-child)")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  ..."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("div.container>div.row+tab：")]),s._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("row"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("栅格系统的列偏移：https://v3.bootcss.com/css/#grid-offsetting")]),s._v(" "),a("h2",{attrs:{id:"_13-分页和-shell-命令行模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_13-分页和-shell-命令行模式"}},[s._v("#")]),s._v(" 13.分页和 shell 命令行模式")]),s._v(" "),a("p",[s._v("快速添加博客(用过 shell 命令行模式添加)：")]),s._v(" "),a("ol",[a("li",[s._v("python manage.py shell")]),s._v(" "),a("li",[s._v("for 循环执行新增博客代码")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('>>> from blog.models import Blog\n>>> Blog.objects.count()\n2\n>>> Blog.objects.all().count()\n2\n>>> blog=Blog()\n>>> blog.title="Django的shell"\n>>> blog.content="**********"\n>>> from blog.models import BlogType\n>>> blog_type=BlogType.objects.all()[0]\n>>> blog.blog_type=blog_type\n>>> from django.contrib.auth.models import User\n>>> user=User.objects.all()[0]\n>>> blog.author=user\n>>> blog.save()\n>>> for i in range(1,30):\n...     blog=Blog()\n...     blog.title="for %s"%i\n...     blog.content="xxxx:%s"%i\n...     blog.blog_type=blog_type\n...     blog.author=user\n...     blog.save()\n... dir()   # 查看当前环境能用的变量\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("django 自带的分页器：\n分页器：from django.core.paginator import Paginator\n具体分页：paginator=Paginator(object_list,each_page_count)\n取第一页：page1=paginator.page(1)\n其他方法：count,num_page,page_range,has_next,has_previous")]),s._v(" "),a("p",[s._v("设置 model 的默认排序(需要 makemigrations+migrate)：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Meta")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    ordering "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-created_time'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("Bootstrap 分页：https://v3.bootcss.com/components/#pagination")]),s._v(" "),a("h2",{attrs:{id:"_14-优化分页展示"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_14-优化分页展示"}},[s._v("#")]),s._v(" 14.优化分页展示")]),s._v(" "),a("p",[s._v("友好的用户体验：当前页高亮、不要过多页码选择，影响页面布局")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[s._v("    current_page_num "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" page_of_blogs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("number  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取当前页码")]),s._v("\n    page_range "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("current_page_num "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" current_page_num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" \\\n                 "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("current_page_num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("min")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("current_page_num "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" paginator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("num_pages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 加上省略页码标记")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" page_range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        page_range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("insert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'...'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" paginator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("num_pages "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" page_range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        page_range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'...'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 加上首页和尾页页码")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" page_range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        page_range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("insert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" page_range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" paginator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("num_pages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        page_range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("paginator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("num_pages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("公用全局设置写到 settings.py 里：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" settings\nsettings"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("xxx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"_15-上下篇博客和按月分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-上下篇博客和按月分类"}},[s._v("#")]),s._v(" 15.上下篇博客和按月分类")]),s._v(" "),a("h3",{attrs:{id:"django-的-filter-筛选查找"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django-的-filter-筛选查找"}},[s._v("#")]),s._v(" django 的 filter 筛选查找")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[s._v("功能")]),s._v(" "),a("th",{staticStyle:{"text-align":"left"}},[s._v("写法")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("大于")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("__gt(greater than)")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("大于等于")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("__gte")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("小于")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("__lt(less than)")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("小于等于")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("__lte")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("包含")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("__contains"),a("br"),s._v("(icontains 忽略大小写)")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("开头是")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("__startwith")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("结尾是")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("__endwith")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("其中之一")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("__in")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("范围")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("__range")])])])]),s._v(" "),a("h3",{attrs:{id:"exclude-排除条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#exclude-排除条件"}},[s._v("#")]),s._v(" exclude 排除条件")]),s._v(" "),a("p",[s._v("用法和 filter 一样，但是是取反")]),s._v(" "),a("h3",{attrs:{id:"django-条件中的双下划线"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django-条件中的双下划线"}},[s._v("#")]),s._v(" django 条件中的双下划线")]),s._v(" "),a("ol",[a("li",[s._v("字段查询类型")]),s._v(" "),a("li",[s._v("外键拓展(以博客分类为例)："),a("code",[s._v("Blog.objects.filter(blog_type__id=blog_type_pk)")])]),s._v(" "),a("li",[s._v("日期拓展(以月份分类为例)："),a("code",[s._v("Blog.objects.filter(created_time__year=2018)")])]),s._v(" "),a("li",[s._v("支持链式查询：可以一直链接下去")])]),s._v(" "),a("p",[s._v("django 的 QuerySet 可以 last()、first()\n返回数据的日期集合："),a("code",[s._v("BlogType.objects.dates('created_time', 'month', order=\"DESC\")")])]),s._v(" "),a("h2",{attrs:{id:"_16-博客分类统计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_16-博客分类统计"}},[s._v("#")]),s._v(" 16.博客分类统计")]),s._v(" "),a("h3",{attrs:{id:"django-中的-annotate-拓展查询字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django-中的-annotate-拓展查询字段"}},[s._v("#")]),s._v(" django 中的 annotate 拓展查询字段")]),s._v(" "),a("p",[s._v("查询到的结果变成一个新字段附带返回")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("models "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Count\ncontext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'blog_types'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" BlogType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("blog_count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'blog'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"_17-博客后台富文本编辑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-博客后台富文本编辑"}},[s._v("#")]),s._v(" 17.博客后台富文本编辑")]),s._v(" "),a("p",[s._v("使用 html 丰富页面：")]),s._v(" "),a("ol",[a("li",[s._v("简单文本编辑——>直接贴入 html 代码")]),s._v(" "),a("li",[s._v("富文本编辑——>最终解析成 html：富文本编辑器、markdown 编辑器")])]),s._v(" "),a("p",[s._v("模板过滤器转义 html："),a("code",[s._v("{ { blog.content|safe } }")]),a("br"),s._v("\n模板过滤器切除 html 标签：striptags")]),s._v(" "),a("h3",{attrs:{id:"django-ckeditor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django-ckeditor"}},[s._v("#")]),s._v(" django-ckeditor")]),s._v(" "),a("p",[s._v("pypi 文档：https://pypi.org/project/django-ckeditor/")]),s._v(" "),a("h4",{attrs:{id:"基本安装配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本安装配置"}},[s._v("#")]),s._v(" 基本安装配置")]),s._v(" "),a("p",[s._v("选择标准：基本富文本编辑功能、上传图片、查看源码、有人维护持续更新\n安装：pip install django-ckeditor\n注册 app：'ckeditor'\n配置 model：把 models.TextField()改成 RichTextField() # 这个字段还不允许上传文件\n此时再通过 admin 进入文章编辑页面就能看到富文本编辑页面了")]),s._v(" "),a("h4",{attrs:{id:"添加图片上传功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加图片上传功能"}},[s._v("#")]),s._v(" 添加图片上传功能")]),s._v(" "),a("ol",[a("li",[s._v("pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pillow")]),s._v(" "),a("li",[s._v("注册 app：'cheditor_uploader'")]),s._v(" "),a("li",[s._v("配置 settings.py")])]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# media")]),s._v("\nMEDIA_URL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/media/'")]),s._v("\nMEDIA_ROOT "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("BASE_DIR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'media'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置ckeditor")]),s._v("\nCKEDITOR_UPLOAD_PATH "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'upload/'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("配置 url")])]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ckeditor'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" include"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ckeditor_uploader.urls'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("把字段改成 RichTextUploadingField")])]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" ckeditor_uploader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fields "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" RichTextUploadingField\ncontent "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" RichTextUploadingField"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("工具栏配置：CKEDITOR_CONFIGS，参考 pypi 中的说明")]),s._v(" "),a("h2",{attrs:{id:"_18-博客阅读简单计数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_18-博客阅读简单计数"}},[s._v("#")]),s._v(" 18.博客阅读简单计数")]),s._v(" "),a("p",[s._v("简单计数处理：Blog 模型添加数字字段记录，每次有人打开，计数+1\n自定义计数规则：可以规定怎么样才算阅读 1 次")]),s._v(" "),a("ol",[a("li",[s._v("无视是否同一人，每次打开都记录")]),s._v(" "),a("li",[s._v("若同一个人，每隔多久算 1 次阅读")])]),s._v(" "),a("h3",{attrs:{id:"设置-cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置-cookie"}},[s._v("#")]),s._v(" 设置 cookie")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[s._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("set_cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("max_age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("expires"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# max_age和expires冲突，max_age单位是分钟，expires类型是datetime，都不设置的话浏览器一关闭就失效")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"获取-cookie"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取-cookie"}},[s._v("#")]),s._v(" 获取 cookie")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("not")]),s._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("COOKIES"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string-interpolation"}},[a("span",{pre:!0,attrs:{class:"token string"}},[s._v("f'blog_")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("blog_pk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("_readed'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    blog"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("readed_num "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    blog"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("该计数方法的缺点：")]),s._v(" "),a("ol",[a("li",[s._v("后台编辑博客可能影响数据")]),s._v(" "),a("li",[s._v("功能单一，无法统计某一天的阅读数")])]),s._v(" "),a("h2",{attrs:{id:"_19-博客阅读计数优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_19-博客阅读计数优化"}},[s._v("#")]),s._v(" 19.博客阅读计数优化")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("计数功能独立\nBlog：博客内容\nRead Num：计数字段")])]),s._v(" "),a("li",[a("p",[s._v("对任意模型计数\n博客、教程、其他：关联哪个模型(Django 的 ContentType 表)，对应主键值")])])]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("contrib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("contenttypes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("models "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" ContentType\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("ContentType 文档：https://docs.djangoproject.com/en/2.1/ref/contrib/contenttypes/")]),s._v(" "),a("p",[s._v("创建一个新 app 专门处理计数问题：\npython manage.py startapp read_statistics")]),s._v(" "),a("h2",{attrs:{id:"_20-阅读计数统计和显示"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_20-阅读计数统计和显示"}},[s._v("#")]),s._v(" 20.阅读计数统计和显示")]),s._v(" "),a("p",[s._v("统计需要记录明细：2 月 1 日——20，2 月 2 日——60，2 月 3 日——80")]),s._v(" "),a("h3",{attrs:{id:"django-的-insert-or-update"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django-的-insert-or-update"}},[s._v("#")]),s._v(" django 的 insert or update")]),s._v(" "),a("p",[s._v("obj, created = Obj.objects.get_or_create(...)")]),s._v(" "),a("h3",{attrs:{id:"django-的-aggregate-聚合求和"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django-的-aggregate-聚合求和"}},[s._v("#")]),s._v(" django 的 aggregate(聚合求和)")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[s._v("read_details "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ReadDetail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("content_type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("content_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" date"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("date"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nresult "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" read_details"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("aggregate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("read_num_sum"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Sum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'read_num'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 聚合")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"使用图表显示数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用图表显示数据"}},[s._v("#")]),s._v(" 使用图表显示数据")]),s._v(" "),a("p",[s._v("后台+前端：后台提供数据，前端使用数据\n这里用的是 Highcharts：https://www.hcharts.cn\n快速上手：https://www.hcharts.cn/docs/start-helloworld\n本节主要使用在了 home.html、home.css 以及 home 的 views 上")]),s._v(" "),a("h2",{attrs:{id:"_21-热门阅读博客排行及缓存提速"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_21-热门阅读博客排行及缓存提速"}},[s._v("#")]),s._v(" 21.热门阅读博客排行及缓存提速")]),s._v(" "),a("p",[s._v("修改代码文件：\nread_statistics/utils.py\nmyblog/views.py\nmyblog/settings.py\ntemplates/home.html # 以及 home.css\nblog/models.py")]),s._v(" "),a("ol",[a("li",[s._v("24 小时——>今日数据统计")]),s._v(" "),a("li",[s._v("昨日——>昨日数据统计")]),s._v(" "),a("li",[s._v("一周")]),s._v(" "),a("li",[s._v("30 天")])]),s._v(" "),a("p",[s._v("每次都计算很耗时：缓存数据，不用每次都计算\n官方文档：https://docs.djangoproject.com/en/2.1/topics/cache/")]),s._v(" "),a("ol",[a("li",[s._v("内存缓存：Memcached、redis")]),s._v(" "),a("li",[s._v("数据库缓存")]),s._v(" "),a("li",[s._v("文件缓存\n缓存配置 settings.py：")])]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[s._v("CACHES "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'default'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BACKEND'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django.core.cache.backends.db.DatabaseCache'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'LOCATION'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my_cache_table'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("创建缓存表：python manage.py createcachetable\n使用：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cache "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" caches\ncache1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" caches"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'myalias'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取指定的链接")]),s._v("\ncache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my_key'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello, world!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my_key'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"番外篇-在-pythonanywhere-部署-django"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#番外篇-在-pythonanywhere-部署-django"}},[s._v("#")]),s._v(" 番外篇：在 pythonanywhere 部署 Django")]),s._v(" "),a("p",[s._v("部署上线常见主机：")]),s._v(" "),a("ol",[a("li",[s._v("pythonanywhere、heroku")]),s._v(" "),a("li",[s._v("云主机：阿里云、亚马逊、其他各种云")])]),s._v(" "),a("p",[s._v("pythonanywhere 官网：https://www.pythonanywhere.com\n注册：https://www.pythonanywhere.com/pricing/\n有付费有免费，免费的不能 ssh，只能用官方提供的网页远程 bash，初始环境自带大量 python 环境和包(可以直接使用 virtualenv 和 virtualenvwrapper)\n部署步骤：")]),s._v(" "),a("ol",[a("li",[s._v("我执行："),a("code",[s._v("mkvirtualenv -p python3.6 Django2.0Tutorial")]),s._v("\nup 主执行："),a("code",[s._v("virtualenv --python=python3.6 venv")])]),s._v(" "),a("li",[s._v("通过 Files 面板可以上传文件(需要压缩成一个)")]),s._v(" "),a("li",[s._v("先导出项目依赖：pip freeze > requirements.txt")]),s._v(" "),a("li",[s._v("压缩整个项目目录上传(Files 选项卡)")]),s._v(" "),a("li",[s._v("解压：unzip myblog.zip——>rm myblog.zip")]),s._v(" "),a("li",[s._v("cd myblog——>pip install -r requirements.txt")]),s._v(" "),a("li",[s._v("点击 Web 选项卡——>不要选 Django，直接选 Manual configuration (including virtualenvs)——>Python3.6——>无脑下一步——>然后会提示可以访问一个以自己用户名开头的二级域名")]),s._v(" "),a("li",[s._v("pwd 输出并复制项目目录：/home/choubaodxs/myblog，填入 Source code 和 Working directory")]),s._v(" "),a("li",[s._v("whereis python 查看自己创建的虚拟环境位置(/home/choubaodxs/.virtualenvs/Django2.0Tutorial)并复制填入到 Virtualenv")]),s._v(" "),a("li",[s._v("点击修改 WSGI configuration file,删除其他内容")])]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" os\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" sys\n\npath "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/home/choubaodxs/myblog'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" path "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("not")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("environ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DJANGO_SETTINGS_MODULE'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'myblog.settings'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("wsgi "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" get_wsgi_application\napplication "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" get_wsgi_application"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("ol",{attrs:{start:"11"}},[a("li",[s._v("此时 reload 一下，打开网页会提示 ALLOWED_HOSTS 相关问题，需要修改 settings.py"),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[s._v("ALLOWED_HOSTS "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'choubaodxs.pythonanywhere.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),s._v("重启一下")]),s._v(" "),a("li",[s._v("出现了部署常见问题，静态文件无法加载，编辑一下 Static files 选项下的 URL 和 Directory 就行：分别是"),a("code",[s._v("/static/")]),s._v("和"),a("code",[s._v("/home/choubaodxs/myblog/static")]),s._v("，reload 一下就成了！记得每三个月一定要来点击一下"),a("code",[s._v("Run until 3 months from today")]),s._v("按钮，否则会被释放")]),s._v(" "),a("li",[s._v("admin 网址的静态文件还没有收集，先配置 settings.py\n"),a("code",[s._v("py STATIC_ROOT = os.path.join(BASE_DIR, 'static')")]),s._v("\n然后执行 python manage.py collectstatic 再访问http://choubaodxs.pythonanywhere.com/admin就能看到样式了")]),s._v(" "),a("li",[s._v("可以像 nginx 用户验证一样设置访问控制，只需要打开 Password protection 就行(dxs dxsadmin123，需要 reload)")])]),s._v(" "),a("h2",{attrs:{id:"_22-评论功能设计和用户登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_22-评论功能设计和用户登录"}},[s._v("#")]),s._v(" 22.评论功能设计和用户登录")]),s._v(" "),a("p",[s._v("实现评论功能的方式：")]),s._v(" "),a("ol",[a("li",[s._v("第三方社会化评论插件：友言、多说、畅言、Disqus、网易云跟帖")]),s._v(" "),a("li",[s._v("Django 评论库：django-comment # 不是很舒服")]),s._v(" "),a("li",[s._v("自己写代码实现")])]),s._v(" "),a("p",[s._v("创建评论模型：评论对象、评论内容、评论时间、评论者\n新建 app：python manage.py startapp comment\n编写 models.py 和 admin.py——>makemigrations 和 migrate\n修改 blog_detail.html，添加评论布局")]),s._v(" "),a("p",[s._v("tips——render 还是要比 render_to_response 灵活好用，up 主这节课把所有 render_to_response 都换成了 render，而且 render_to_response 是不处理 csrf_token 的，建议以后都用 render 了。")]),s._v(" "),a("h2",{attrs:{id:"_23-html-表单提交评论"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_23-html-表单提交评论"}},[s._v("#")]),s._v(" 23.html 表单提交评论")]),s._v(" "),a("p",[s._v("本节变动代码文件：\ncomment/urls.py、views.py\nmyblog/settings.py\nblog_detail.html\nblog/views.py\n提交评论：评论对象、评论内容、评论时间、评论者")]),s._v(" "),a("h3",{attrs:{id:"django-的-reverse、redirect、render"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django-的-reverse、redirect、render"}},[s._v("#")]),s._v(" Django 的 reverse、redirect、render")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("login")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    username "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("POST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'username'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    password "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("POST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'password'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" auth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authenticate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    referer "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("META"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'HTTP_REFERER'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" reverse"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'home'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("not")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        auth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("login"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" redirect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("referer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" render"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'error.html'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'message'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'用户名或密码不正确'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("多行输入标签：textarea\n自己检查用户输入的合法性太麻烦了，下节课介绍 Django 的 Form 类")]),s._v(" "),a("h2",{attrs:{id:"_24-使用-django-form-表单"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_24-使用-django-form-表单"}},[s._v("#")]),s._v(" 24.使用 Django Form 表单")]),s._v(" "),a("p",[s._v("本节变动代码文件：\ntemplates/login.html\ntemplates/register.html\nmyblog/urls.py\nmyblog/views.py\nmyblog/forms.py")]),s._v(" "),a("p",[s._v("Django Form 的作用：\nDjango 用 Form 类描述 html 表单，帮助简化操作")]),s._v(" "),a("ol",[a("li",[s._v("接收和处理用户提交的数据\n可检查提交的数据\n可将数据转换成 Python 的数据类型")]),s._v(" "),a("li",[s._v("可自动生成 html 代码")])]),s._v(" "),a("p",[s._v("Django Form 的每个字段类型都有一个适当的默认 Widget 类。")]),s._v(" "),a("p",[s._v("具体联动代码见：")]),s._v(" "),a("ul",[a("li",[s._v("myblog/myblog/forms.py")]),s._v(" "),a("li",[s._v("myblog/templates/login.html")]),s._v(" "),a("li",[s._v("myblog/myblog/views.py")])]),s._v(" "),a("h2",{attrs:{id:"_25-富文本编辑和-ajax-提交评论"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_25-富文本编辑和-ajax-提交评论"}},[s._v("#")]),s._v(" 25.富文本编辑和 ajax 提交评论")]),s._v(" "),a("p",[s._v("本节变动代码文件：\ncomment/forms.py\ncomment/views.py\nblog/views.py\nblog_detail.html\nmyblog/settings.py # 添加 ckeditor 的 config 来决定显示哪些控件\nblog/blog.css")]),s._v(" "),a("h3",{attrs:{id:"django-ckeditor-富文本表单"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django-ckeditor-富文本表单"}},[s._v("#")]),s._v(" django-ckeditor 富文本表单")]),s._v(" "),a("p",[s._v("django-ckeditor 提供 widget")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" ckeditor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("widgets "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" CKEditorWidget\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\ntext "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" forms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CharField"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("widget"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("CKEditorWidget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("config_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'comment_ckeditor'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                           error_messages"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'required'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'评论内容不能为空'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text/javascript"')]),s._v(" src"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{% static "')]),s._v("ckeditor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ckeditor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" %}"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text/javascript"')]),s._v(" src"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{% static "')]),s._v("ckeditor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ckeditor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ckeditor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" %}"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("文档：https://github.com/django-ckeditor/django-ckeditor#widget")]),s._v(" "),a("h3",{attrs:{id:"ajax-提交"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ajax-提交"}},[s._v("#")]),s._v(" ajax 提交")]),s._v(" "),a("p",[s._v("正常提交会刷新整个页面，可以通过 ajax 提交数据，ajax 提交是一种不刷新页面的异步提交方式。")]),s._v(" "),a("p",[s._v("日期过滤器：Y-m-d H:i:s\nsettings.py 中时区设置：TIME_ZONE='Asia/Shanghai'")]),s._v(" "),a("h2",{attrs:{id:"_26-回复功能设计和树结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_26-回复功能设计和树结构"}},[s._v("#")]),s._v(" 26.回复功能设计和树结构")]),s._v(" "),a("p",[s._v("本节变动代码文件：\ncomment/models.py\nblog/views.py\nblog_detail.html\ncomment/forms.py\ncomment/views.py")]),s._v(" "),a("p",[s._v("如何设计回复功能：评论可被回复、回复可被回复\n给 Comment 新增字段然后迁移(注意有两个 User 外键以及 related_name 的使用)：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Comment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ForeignKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" on_delete"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DO_NOTHING"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ForeignKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'self'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" related_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root_comment'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" null"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" on_delete"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CASCADE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    parent "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ForeignKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'self'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" related_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'parent_comment'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" null"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" on_delete"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CASCADE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    reply_to "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ForeignKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" related_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"replies"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" null"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" on_delete"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("models"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CASCADE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"_27-获取评论数和细节处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_27-获取评论数和细节处理"}},[s._v("#")]),s._v(" 27.获取评论数和细节处理")]),s._v(" "),a("p",[s._v("本节变动代码文件：\nblog/views.py\ncomment/templatetags/comment_tags.py\nblog_detai.html\nblog_list.html")]),s._v(" "),a("p",[s._v("如何获取评论数：\n方法：filter 筛选再用 count 方法计数\n问题：页面和代码更加复杂了")]),s._v(" "),a("h3",{attrs:{id:"自定义模板标签"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义模板标签"}},[s._v("#")]),s._v(" 自定义模板标签")]),s._v(" "),a("p",[s._v("降低耦合，代码更加独立、使用更加简单\n在 app 内创建 templatetags 包——>创建 py 文件——>load 加载该文件\ntips——django 模板语言的 as：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" get_comment_form blog "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" comments "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" comment "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" comments "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# {% for field in comment_form %} #}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" field "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" endfor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("细节处理：\najax 返回的日期\nCSS 样式调整\n级联删除：DO_NOTHING——>CASCADE 级联删除\ndjango-ckeditor")]),s._v(" "),a("h2",{attrs:{id:"_28-用所学知识实现点赞功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_28-用所学知识实现点赞功能"}},[s._v("#")]),s._v(" 28.用所学知识实现点赞功能")]),s._v(" "),a("p",[s._v("本节变动代码文件：\n需要新建一个 app：python manage.py startapp likes\nblog_detail.html\nmyblog/settings.py\nmyblog/urls.py\nblog_list.html")]),s._v(" "),a("p",[s._v("点赞功能设计：\n博客、评论、回复可点赞\n可取消点赞\n可看到点赞总数")]),s._v(" "),a("p",[s._v("这节课我出了点问题，说"),a("code",[s._v("xxx is not a registered tag library.")]),s._v("\n多个 templatetags 时，需要在 settings.py 的 TEMPLATES 中配置 libraries。")]),s._v(" "),a("p",[s._v("ajax 有个缓存参数：cache: false // 取消缓存")]),s._v(" "),a("p",[s._v("前后端开发建议：功能需求分析——>模型设计——>前端初步开发——>后端实现——>完善前端代码\n运用所学到的知识：Django 基础(models,views,urls)、ContentType、ajax、自定义模板标签")]),s._v(" "),a("h2",{attrs:{id:"_29-完善点赞功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_29-完善点赞功能"}},[s._v("#")]),s._v(" 29.完善点赞功能")]),s._v(" "),a("p",[s._v("本节变动代码文件：\nblog_detail.html\nmyblog/urls.py\nmyblog/views.py")]),s._v(" "),a("p",[s._v("完善点赞功能：")]),s._v(" "),a("ol",[a("li",[s._v("新增评论无和回复无法点赞(需要添加 onclick 事件)")]),s._v(" "),a("li",[s._v("未登录情况下点赞")])]),s._v(" "),a("p",[s._v("通过 js 简单实现 python 的 format 方法：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// '{0}-{1}'.format(x,y)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("format")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" str "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    str "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RegExp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\\\{"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\\\}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"g"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" str\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("Bootstrap 模态框：https://v3.bootcss.com/javascript/#modals\n实现功能：未登录点赞时弹出登录框，blog_detail.html 添加代码")]),s._v(" "),a("h2",{attrs:{id:"_30-导航栏添加用户操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_30-导航栏添加用户操作"}},[s._v("#")]),s._v(" 30.导航栏添加用户操作")]),s._v(" "),a("p",[s._v("本节变动代码文件：\n需要新建一个 app：python manage.py startapp user\nmyblog/templates/base.html\nblog_detail.html\n...")]),s._v(" "),a("p",[s._v('本节实现：导航栏右侧添加"登录/注册"或用户信息')]),s._v(" "),a("p",[s._v("tips——把所有 app 整理到一个 apps 目录：新建一个 apps 目录，pycharm 可以右键 make as source root，settings.py 添加一句")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[s._v("sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("insert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("BASE_DIR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'apps'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"django-技巧-context-processors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django-技巧-context-processors"}},[s._v("#")]),s._v(" Django 技巧 context_processors")]),s._v(" "),a("p",[s._v("代码见：/apps/user/context_processors.py 和 settings.py 中 context_processors 配置，在 blog_detail.html 使用")]),s._v(" "),a("h2",{attrs:{id:"_31-自定义用户模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_31-自定义用户模型"}},[s._v("#")]),s._v(" 31.自定义用户模型")]),s._v(" "),a("p",[s._v("本节变动代码文件：\nuser/models.py\nuser/admin.py")]),s._v(" "),a("p",[s._v("拓展方法：继承 Django 的用户模型、新的模型关联 User 进行拓展\n官网文档：https://docs.djangoproject.com/en/2.1/topics/auth/customizing/")]),s._v(" "),a("h3",{attrs:{id:"通过继承拓展-django-的-user-模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过继承拓展-django-的-user-模型"}},[s._v("#")]),s._v(" 通过继承拓展 Django 的 User 模型")]),s._v(" "),a("p",[s._v("方法： 1)自定义模型继承 AbstractUser 2)配置 settings 的 AUTH_USER_MODEL\n使用：\n外键关联 settings.AUTH_USER_MODEL\n用 get_user_model 方法获取 User 模型")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("contrib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("auth "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" get_user_model\nUser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" get_user_model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("注意：在进行大量开发操作(特别是外键关联 User 之后)后再重写 User 模型的话，需要删除所有数据库迁移文件(migrations 目录)以及重置数据库。")]),s._v(" "),a("p",[s._v("这种方式的优缺点：\n优点： 1)自定义强 2)没有不必要的字典(继承自 AbstractUser)\n缺点： 1)需要删库重来或者项目一开始就使用 2)配置 admin 麻烦")]),s._v(" "),a("h3",{attrs:{id:"通过关联拓展-django-的-user-模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过关联拓展-django-的-user-模型"}},[s._v("#")]),s._v(" 通过关联拓展 Django 的 User 模型")]),s._v(" "),a("p",[s._v("方法： 1)创建自定义模型 2)外键关联 User\n使用：随便用")]),s._v(" "),a("p",[s._v("这种方式的优缺点：\n优点： 1)使用方便 2)不用删库重来影响整体架构")]),s._v(" "),a("p",[s._v("缺点： 1)存在不必要的字典 2)对比继承方法，查询速度稍稍慢一丁点")]),s._v(" "),a("h2",{attrs:{id:"_32-修改用户信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_32-修改用户信息"}},[s._v("#")]),s._v(" 32.修改用户信息")]),s._v(" "),a("p",[s._v("本节修改代码：\nuser/forms.py\nuser/views.py\nuser/urls.py\nuser/models.py\nuser_info.html\nsettings.py\ntemplates/form.html # 通用表单页面")]),s._v(" "),a("p",[s._v("修改用户信息：昵称、邮箱、密码\n修改昵称：user 不一定有对应的 Profile(未创建)、昵称不能为空(Form)判断")]),s._v(" "),a("p",[s._v("tips——给 User 类动态添加方法(详细见 user/models.py)：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("has_nickname")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" Profile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exists"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("has_nickname "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" has_nickname\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"django-发送邮件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#django-发送邮件"}},[s._v("#")]),s._v(" Django 发送邮件")]),s._v(" "),a("p",[s._v("先去打开邮箱的 SMTP 服务并记录授权码\nsettings.py 配置：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[s._v("EMAIL_BACKEND "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'django.core.mail.backends.smtp.EmailBackend'")]),s._v("\nEMAIL_HOST "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'smtp.qq.com'")]),s._v("\nEMAIL_PORT "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("\nEMAIL_HOST_USER "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2872402050@qq.com'")]),s._v("\nEMAIL_HOST_PASSWORD "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wyejaniudikedfbb'")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 授权码")]),s._v("\nEMAIL_SUBJECT_PREFIX "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[杨仕航的博客] '")]),s._v("\nEMAIL_USE_TLS "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与SMTP服务器通信时，是否启动TLS链接(安全链接)")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("使用：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" django"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mail "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" send_mail\nsend_mail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'绑定邮箱'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("              "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主题")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'验证码：%s'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内容")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2872402050@qq.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发送人")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("email"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目标邮箱")]),s._v("\n    fail_silently"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"_33-发挥邮箱作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_33-发挥邮箱作用"}},[s._v("#")]),s._v(" 33.发挥邮箱作用")]),s._v(" "),a("p",[s._v("本节修改文件：\nuser/forms.py\nuser/views.py\nuser/*.html")]),s._v(" "),a("p",[s._v("邮箱发挥的作用：减少垃圾用户、保证账户安全、推送消息(通知)\n引导用户填写邮箱：1.注册的时候就要求填写(邮箱验证码、邮箱验证连接、邮箱注册);2.可以后续绑定邮箱")]),s._v(" "),a("p",[s._v("注意点：注册或绑定邮箱完成后，清除一下 session")]),s._v(" "),a("p",[s._v("修改登录方式，让用户名和邮箱都可以登录：修改 LoginForm 即可")]),s._v(" "),a("p",[s._v("修改密码的实现：1.登录情况下的修改密码；2.忘记密码时修改密码")]),s._v(" "),a("h2",{attrs:{id:"_34-评论发送邮件通知"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_34-评论发送邮件通知"}},[s._v("#")]),s._v(" 34.评论发送邮件通知")]),s._v(" "),a("p",[s._v("本节修改代码：\ncomment/models.py\ncomment/views.py\ncomment/templates/send_email.html")]),s._v(" "),a("p",[s._v("利用邮件提高访问量：\n进一步发挥邮箱作用：一旦被评论(回复)了，发邮件通知让用户再次访问我们的网站(我感觉这个功能不好，很烦的好吧)")]),s._v(" "),a("p",[s._v("异步发送邮件：\n简单方案：多线程——>简单、实现快\n复杂方法：Celery——>可防止任务过多、可定时执行一些任务、开销更大")]),s._v(" "),a("p",[s._v("代码中下一个断点(Sublime 用用)：")]),s._v(" "),a("div",{staticClass:"language-py line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-py"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" pdb\npdb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("set_trace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("html 邮件：让邮件更好看，但容易被判定为垃圾邮件。\n网址问题：服务器、域名、数据库、git 管理代码版本")]),s._v(" "),a("h2",{attrs:{id:"_35-部署准备-一-git"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_35-部署准备-一-git"}},[s._v("#")]),s._v(" 35.部署准备（一）：Git")]),s._v(" "),a("p",[s._v("Git 是一款开源的分布式版本控制系统：随着敲代码和修改代码，我们的代码会更新很多个版本——>版本控制系统：控制代码版本")]),s._v(" "),a("p",[s._v("为什么使用 Git：")]),s._v(" "),a("ol",[a("li",[s._v("快速控制服务器代码版本")]),s._v(" "),a("li",[s._v("有利于团队协作")])]),s._v(" "),a("p",[s._v("如何使用：\n现有代码——>编辑区——>暂存区——>版本库")]),s._v(" "),a("ol",[a("li",[s._v("安装 Git(Linux 和 Mac 一般默认有 Git)")]),s._v(" "),a("li",[s._v("使用 Github")]),s._v(" "),a("li",[s._v("下载代码：git clone")]),s._v(" "),a("li",[s._v("查看状态：git status")]),s._v(" "),a("li",[s._v("添加文件到暂存区：git add.")]),s._v(" "),a("li",[s._v("忽略文件：ignore")]),s._v(" "),a("li",[s._v('提交代码：git commit -m "描述"')]),s._v(" "),a("li",[s._v("git push 和 git pull")]),s._v(" "),a("li",[s._v("git checkout .和 git reset")]),s._v(" "),a("li",[s._v("git log")])]),s._v(" "),a("p",[s._v("注：windows 下 git 相关设置(用户名，邮箱等)在 Administrator 目录下的.gitconfig 中，删掉就相当于清空了")]),s._v(" "),a("p",[s._v("使用 git：")]),s._v(" "),a("ol",[a("li",[s._v("github 上创建一个空仓库，使用 git 克隆项目：git clone repository_url")]),s._v(" "),a("li",[s._v("把自己的代码扔到这个目录里，执行 git add . #将所有文件添加到暂存区")]),s._v(" "),a("li",[s._v("在目录下创建一个.gitignore 文件，填入需要忽略的文件"),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.sqlite3\nsettings.py\n__pycache__/    # /表示文件夹\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[s._v("此时需要还原一下暂存区：git reset，然后再执行 git add .")]),s._v(" "),a("li",[s._v("设置一下提交用的用户名和邮箱："),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('git config --global user.email "110@qq.com"\ngit config --global user.name "username"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[s._v("将暂存区提交到版本库：git commit -m '第一次提交'")]),s._v(" "),a("li",[s._v("git log 查看提交历史(一行显示：git log --oneline)")]),s._v(" "),a("li",[s._v("推送到 github 仓库：git push")]),s._v(" "),a("li",[s._v("拉取代码：git pull")])]),s._v(" "),a("p",[s._v("推荐学习 git：https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000")]),s._v(" "),a("h2",{attrs:{id:"_36-部署准备-二-mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_36-部署准备-二-mysql"}},[s._v("#")]),s._v(" 36.部署准备（二）：MySQL")]),s._v(" "),a("p",[s._v("什么是 MySQL：MySQL 是一款跨平台的开源的关系型数据库")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}}),s._v(" "),a("th",{staticStyle:{"text-align":"left"}},[s._v("MySQL")]),s._v(" "),a("th",{staticStyle:{"text-align":"left"}},[s._v("SQLite")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("特点")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("为服务器端而设计")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("轻量级、可嵌入")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("高并发访问")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("能")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("不能")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("占用内存")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("较大")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("小")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[s._v("适用性")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("服务器")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("适合桌面应用和手机应用")])])])]),s._v(" "),a("p",[s._v("如何使用：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("安装 MySQL 1)下载 MySQL\n注意：这里 up 主下载的是压缩包，我建议是直接下载无脑版安装器(https://dev.mysql.com/downloads/windows/installer/8.0.html)\n假如是下载的压缩包(https://dev.mysql.com/downloads/mysql/)：解压后在目录新建一个 my.ini 配置文件，内容大致如下，网上也可以找到：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# my.ini\n[mysqld]\nbasedir=C:/mysql-8.0.11-winx64\ndatadir=C:/mysql-8.0.11-winx64/data\nport=3306\nmax_connections=200\nmax_connect_errors=10\ncharacter-set-server=utf8mb4\ncollation-server=utf8mb4_general_ci\ndefault-storage-engine=INNODB\ndefault_authentication_plugin=mysql_native_password\n\n[mysql]\ndefault-character-set=utf8mb4\n\n[client]\ndefault-character-set=utf8mb4\nport=3306\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("p",[s._v("接下来初始化，进入到 bin 目录执行：mysqld --initialize-insecure --user=mysql --console——>初始化完后执行：mysqld --install——>启动服务：net start mysql——>进入交互：mysql -u root -p 2)路径加入系统环境变量：就是配置一下 bin 目录到环境变量 3)配置 MySQL 4)启动服务 5)设置 root 密码\nalter user 'root'@'localhost' identified by 'admin123'")])]),s._v(" "),a("li",[a("p",[s._v("创建数据库(注意字符编码)")])]),s._v(" "),a("li",[a("p",[s._v("创建表(应用数据库迁移文件)")])]),s._v(" "),a("li",[a("p",[s._v("若有缓存表，也需要创建")])])]),s._v(" "),a("p",[s._v("Django 配置 MySQL 相关文档：https://docs.djangoproject.com/en/2.1/ref/settings/#databases")]),s._v(" "),a("p",[s._v("注意——root 用户直连数据库是很危险的，需要建一个专门的用户供开发使用：")]),s._v(" "),a("ol",[a("li",[s._v("mysql -u root -p 进入交互")]),s._v(" "),a("li",[s._v("create user 'dxs'@'localhost' identified by 'dxs123456'; # 想要任意主机访问，localhost 可以改成%")]),s._v(" "),a("li",[s._v("赋予该用户有关数据库的全部权限：grant all privileges on databasename.tablename to 'dxs'@'localhost' # tablename 可以换成*,localhost 可以换成%")])]),s._v(" "),a("p",[s._v("windows 下载安装 mysqlclient：https://www.lfd.uci.edu/~gohlke/pythonlibs/#mysqlclient\npip install mysqlclient‑1.3.13‑cp36‑cp36m‑win_amd64.whl 即可")]),s._v(" "),a("p",[s._v("Django 导出数据库数据和导入数据库数据(SQLite——>MySQL)：\npython manage.py dumpdata > data.json\npython manage.py loaddata data.json")]),s._v(" "),a("p",[s._v("windows 下 MySQL 下载时区表(其实 Django 中设置 USE_TZ = False 即可)：https://dev.mysql.com/downloads/timezones.html，下载完后按照文档导入到MySQL。")]),s._v(" "),a("h2",{attrs:{id:"_37-部署准备-三-服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_37-部署准备-三-服务器"}},[s._v("#")]),s._v(" 37.部署准备（三）：服务器")]),s._v(" "),a("p",[s._v("什么是服务器：为了让别人通过互联网访问到我们的网站，需要在互联网上的服务器上部署我们的网站")]),s._v(" "),a("ol",[a("li",[s._v("租用或购买别人的服务器:传统服务器、云服务器(传统服务器虚拟化)")]),s._v(" "),a("li",[s._v("把自己电脑弄成服务器并接入互联网")])]),s._v(" "),a("p",[s._v("去阿里云、腾讯云、xx 云随便买个服务器，我是推荐搬瓦工的，还可以顺便搭个 vpn。")]),s._v(" "),a("p",[s._v("常见的服务器操作系统：\nWindows：Asp/Asp.net/、相对不安全、易用、性能弱\nLinux：Python/Go/Java/PHP、安全性强、上手难、性能高\n部署 Django 建议 Linux：Ubuntu(更多支持、apt-get)、CentOS(更稳定、yum)\nUP 主选择 Unbutn 做演示。")]),s._v(" "),a("p",[s._v("远程连接服务器：ssh 或者 xshell\nssh 连接：ssh username@ip\n安装网站运行基础：")]),s._v(" "),a("ol",[a("li",[s._v("代码运行基础：Python")]),s._v(" "),a("li",[s._v("传输代码：git、scp、ftp")]),s._v(" "),a("li",[s._v("数据库：MySQL")])]),s._v(" "),a("p",[s._v("具体步骤全都跳过跳过，看以前自己的笔记好吧")]),s._v(" "),a("p",[s._v("注意设置：ALLOWED_HOSTS = ['*']\n后续使用 web 服务器软件部署网站后面再讲：Apache、Nginx、IIS")]),s._v(" "),a("h2",{attrs:{id:"_38-用-apache-mod-wsgi-部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_38-用-apache-mod-wsgi-部署"}},[s._v("#")]),s._v(" 38.用 Apache+mod_wsgi 部署")]),s._v(" "),a("p",[s._v("WSGI 规范：Web Server Gateway Interface\nLinux 常用的 web 服务器软件：Apache、Nginx")]),s._v(" "),a("ul",[a("li",[s._v("Apache：模块多、功能强大、内置了对 PHP、Python、Perl 和其他语言的支持")]),s._v(" "),a("li",[s._v("Nginx(Engine-x)：轻量级、抗高并发、速度快")])]),s._v(" "),a("p",[s._v("Django 官方文档：https://docs.djangoproject.com/en/2.1/howto/deployment/wsgi/modwsgi/\nhttps://modwsgi.readthedocs.io/en/develop/user-guides/quick-installation-guide.html")]),s._v(" "),a("h3",{attrs:{id:"使用-apache-mode-wsgi-部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-apache-mode-wsgi-部署"}},[s._v("#")]),s._v(" 使用 Apache+mode_wsgi 部署")]),s._v(" "),a("p",[s._v("1)安装 Apache 2)编译 mod_wsgi 3)配置")]),s._v(" "),a("p",[s._v("具体步骤：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1、安装apache\n\t1）安装命令\n\tapt-get install apache2\n\n\t2）相关文件或文件夹\n\t/etc/apache2/\n\t/var/log/apache2/error.log\n\n\t3）相关命令\n\tapache2ctl configtest\n\tapache2ctl restart\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("2.mod_wsgi建议编译安装，不要apt-get\n# 参考 https://modwsgi.readthedocs.io/en/develop/user-guides/quick-installation-guide.html\n\n    1）安装必须的软件\n        apt-get update\n        apt-get install libapache2-mod-wsgi-py3\n\n    2）下载并解压mod_wsgi源码包\n    # 去这里复制一下源码地址(在tar.gz那里右键复制链接地址)：https://github.com/GrahamDumpleton/mod_wsgi/releases\n    wget https://github.com/GrahamDumpleton/mod_wsgi/archive/4.6.4.tar.gz # 就是复制得到的链接\n    tar xvfz 4.6.4.tar.gz # 解压\n\n    3）查询相关命令的位置\n\twhereis apxs\n\twhereis python3.6\n\n    4）编译安装mod_wsgi\n\tapt-get install apache2-dev\n\tcd mod_wsgi-4.6.4\n\t./configure --with-apxs=/usr/bin/apxs --with-python=/usr/bin/python3.6\n\tmake\n\tmake install\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("3、配置 apache")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("查询虚拟环境python的位置：python -c 'import sys; print(sys.prefix)'\n\n进入apache目录：cd /etc/apache2\n查看wsgi是否已经启用：a2enmod wsgi\n进入可用站点配置目录：cd /etc/apache2/sites-availables\n在可用站点配置目录新建一个配置文件：vim mysite.conf，填入以下内容\n\n<VirtualHost *:80>\n    WSGIDaemonProcess mysite(随便起) python-home=/home/mysite_env(虚拟环境目录) python-path=/home/mysite(项目目录)\n    WSGIProcessGroup mysite(随便起)\n    WSGIScriptAlias / /home/mysite/mysite/wsgi.py   # Django项目里的wsgi.py\n\n    <Directory /home/mysite/mysite>\n        <Files wsgi.py>\n            Require all granted\n        </Files>\n    </Directory>\n\n    # 开放media文件目录\n    Alias /media/ /home/mysite/meida/\n    <Directory /home/mysite/media>\n        Require all granted\n    </Directory>\n\n    # 开放静态文件目录\n    Alias /static/ /home/mysite/static/\n    <Directory /home/mysite/static>\n        Require all granted\n    </Directory>\n</VirtualHost>\n\napache启用站点：a2ensite mysite.conf\napache关闭站点：a2dissite 000-default.conf\n重启apache(和Nginx一样,重启前先检查配置)：apache2ctl configtest——>apache2ctl restart\n查看apache错误日志：cat /var/log/apache2/error.log\n最后就是注意settings.py里的DEBUG=True，STATIC_ROOT以及python manage.py collectionstatic\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("p",[s._v("tips——命令行窗口直接执行 python：python -c 'import sys; print(sys.prefix)'")]),s._v(" "),a("h2",{attrs:{id:"_39-用-nginx-uwsgi-部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_39-用-nginx-uwsgi-部署"}},[s._v("#")]),s._v(" 39.用 Nginx+uWSGI 部署")]),s._v(" "),a("p",[s._v("参考文档：\n（Django 官网）https://docs.djangoproject.com/en/2.1/howto/deployment/wsgi/uwsgi/\n（uwsgi 中文）https://uwsgi-docs-zh.readthedocs.io/zh_CN/latest/tutorials/Django_and_nginx.html\n（uwsgi 英文）https://uwsgi.readthedocs.io/en/latest/tutorials/Django_and_nginx.html\n（自强学堂）https://code.ziqiangxuetang.com/django/django-nginx-deploy.html")]),s._v(" "),a("p",[s._v("1)安装 uwsgi 2)测试 uwsgi 3)安装 Nginx 4)配置")]),s._v(" "),a("p",[s._v("tips——快速杀死目标 uwsgi 进程：ps -aux | grep uwsgi |awk '{print $2}'|xargs kill -9\n注意点：服务器安全组策略打开测试用端口\ntips——/etc/nginx/sites-available/mysite.conf 目录存放可用的站点配置，/etc/nginx/sites-enabled/mysite.conf 目录存放已经启用的站点配置(apache 类似)")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1、安装uwsgi\n注意：\n\t1）在系统环境安装，非虚拟环境\n\t2）使用对应python版本安装\n\t3）要先安装python开发包\n\npip3 install uwsgi\n\n\n2、测试 uwsgi 是否正常：\n新建 test.py 文件，内容如下：\ndef application(env, start_response):\n    start_response('200 OK', [('Content-Type','text/html')])\n    return \"Hello World\"\n\n然后在终端运行：\nuwsgi --http :8001 --wsgi-file test.py\n注意：需要开启端口才可以正常访问\n\n\n3、可以用uwsgi的http协议访问django写的网站\n执行如下命令可以测试自己的项目\nuwsgi --http :8001 --chdir /home/mysite --home /home/mysite_env --module mysite.wsgi:application\n\n\n4、安装nginx\n若有安装过apache，要先把apache服务关闭(apache2ctl stop)\napt-get update\napt-get install nginx\n\n# 移除default\n# rm /etc/nginx/sites-enabled/default\n\n进入sites-available创建新的配置\ncd /etc/nginx/sites-available/\nvim mysite.conf\n\n配置可以参考下面：\nserver {\n    listen 80;\n    server_name mysite;\n    charset utf-8;\n\n    client_max_body_size 75M;\n\n    location /static {\n        alias /home/mysite/static;\n    }\n\n    location /media {\n        alias /home/mysite/media;\n    }\n\n    location / {\n        uwsgi_pass 127.0.0.1:8001;\n        include /etc/nginx/uwsgi_params;\n    }\n}\n\n再设置软链接到sites-enabled\nln -s /etc/nginx/sites-available/mysite.conf /etc/nginx/sites-enabled/mysite.conf\n\n\n5、配置uwsgi，创建ini文件方便处理。ini参考如下：\n[uwsgi]\nchdir = /home/mysite     # 项目目录\nhome = /home/mysite_env  # 虚拟环境目录\nmodule = mysite.wsgi:application\n\nmaster = True\nprocesses = 4       # 进程数\nharakiri = 60       # 请求超时时间\nmax-requests = 5000 # 单个进程处理请求数达到该数时就重启防止内存泄漏\n\nsocket = 127.0.0.1:8001\nuid = 1000\ngid = 2000\n\npidfile = /home/mysite_uwsgi/master.pid # 通过pid进行启动 停止 重启操作\ndaemonize = /home/mysite_uwsgi/mysite.log\nvacuum = True\n\n\n6、启动uwsgi\nuwsgi --ini /home/mysite_uwsgi/mysite.ini\n\n\n7、重启nginx\nservice nginx restart\n\n=======================\n其他参考：\nnginx测试命令：nginx -t\n查看uwsgi进程：ps -aux | grep uwsgi\n正常关闭uwsgi进程：uwsgi --stop /home/mysite_uwsgi/master.pid\n强制关闭全部uwsgi进程：ps -aux | grep uwsgi |awk '{print $2}'|xargs kill -9\n重新加载uwsgi：uwsgi --reload /home/mysite_uwsgi/master.pid\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br")])]),a("h2",{attrs:{id:"番外篇-在-windows-部署-django"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#番外篇-在-windows-部署-django"}},[s._v("#")]),s._v(" 番外篇：在 Windows 部署 Django")]),s._v(" "),a("p",[s._v("系统环境：Windows Server 2008 R2、Python3.6、Django2\nwindows 远程连接：win+r 运行 mstsc")]),s._v(" "),a("p",[s._v("windows 提供 web 服务常规方式：\nWeb 服务软件：IIS\n规范：FastCGI python 库：wfastcgi")]),s._v(" "),a("h3",{attrs:{id:"使用-iis-和-wfastcgi-部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-iis-和-wfastcgi-部署"}},[s._v("#")]),s._v(" 使用 IIS 和 wfastcgi 部署")]),s._v(" "),a("p",[s._v("wfastcgi 文档：https://pypi.org/project/wfastcgi/ 1)首先确保 Python 和对应所需的环境和库已经安装好 2)启用 IIS，选上 CGI")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("开始——>管理工具——>服务器管理器——>添加角色——>下一步，勾选Web服务器(IIS)，下一步，\n下一步——>角色服务选项中勾选CGI，下一步——>安装——>完成后关闭——>开始菜单或者管理工具\n里就能看到IIS管理器了——>打开后展开左侧选项卡，会有一个Default Web Site，此时使用\n服务器公网ip访问就能看到IIS相关页面\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("3)添加网站，安装 wfastcgi")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("把项目和python env放到IIS目录(可以避免很多权限问题)——>C:\\inetpub\\wwwroot\n在IIS管理器左侧选项卡中右键`网站`——>添加网站——>填写物理路径，网站名称随便写mysite，类型IP地址端口随意\n系统默认python环境安装好wfastcgi：pip install wfastcgi\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("4)复制 wfastcgi 到项目目录(IIS 权限需要)")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("复制python\\Lib\\site-packages目录下的wfastcgi.py到项目目录(和manage.py一起)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("5)配置 FastCGI 映射")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("IIS管理器中选中我们的网址，点击处理程序映射——>右侧操作添加模块映射，配置如下：\n请求路径：*\n模块：FastCgiModule\n可执行文件：C:\\inetpub\\wwwroot\\mysite\\env\\Scripts\\python.exe|C:\\inetpub\\wwwroot\\mysite\\wfastcgi.py\n名称：DjangoHandler(随意)\n然后点击确定\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("6)配置 FastCGI 参数")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# 文档：https://pypi.org/project/wfastcgi/\n在项目根目录(manage.py同级)新建一个web.config，写入\n<configuration>\n  <appSettings>\n    \x3c!-- Required settings --\x3e\n    <add key="WSGI_HANDLER" value="django.core.wsgi.get_wsgi_application()" />\n    <add key="PYTHONPATH" value="C:\\inetpub\\wwwroot\\mysite" />\n\n    \x3c!-- Optional settings --\x3e\n    <add key="WSGI_LOG" value="C:\\Logs\\mysite.log" />\n    <add key="WSGI_RESTART_FILE_REGEX" value=".*((\\.py)|(\\.config))$" />\n    <add key="DJANGO_SETTINGS_MODULE" value="mysite.settings" />\n  </appSettings>\n</configuration>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("7)给需要写入的文件添加写入权限\n主要是数据库文件(比如 sqlite)权限以及日志文件权限：右键文件——>属性——>安全——>点击组或用户名中的 IIS——>编辑——>添加各种权限——>应用 8)设置静态目录 1.和平常一样，先设置 settings.py 中的 STATIC_ROOT，然后 python manage.py collectionstatic。 2.在 IIS 管理器右侧右键我们的网站——>添加虚拟目录——>别名随意，路径指向 static 目录，重启——>发现还是有问题，原因是 IIS 无法既处理动态又处理静态，解决方案如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# mysite/urls.py添加代码\n# Django自己处理静态文件\nfrom django.conf import settings\nfrom django.conf.urls.static import static\nurlpatterns += static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("重启网站就 OK 了，另外，如果有 media 目录需要上传文件，要记得给 IIS 写入权限。")]),s._v(" "),a("h2",{attrs:{id:"没了"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#没了"}},[s._v("#")]),s._v(" 没了")])])}),[],!1,null,null,null);t.default=e.exports}}]);