(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{1009:function(e,s,a){"use strict";a.r(s);var r=a(12),n=Object(r.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[e._v("应运维组大佬要求，整理一下本地搭建jumpserver开发环境步骤")])]),e._v(" "),a("p",[e._v("[TOC]")]),e._v(" "),a("h2",{attrs:{id:"jumpserver架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jumpserver架构"}},[e._v("#")]),e._v(" jumpserver架构")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/ChouBaoDxs/MyResources/blob/master/image/%E8%BF%90%E7%BB%B4/Jumpserver/jumpserver%E6%9E%B6%E6%9E%84.jpg?raw=true",alt:"jumpserver架构"}}),e._v(" "),a("code",[e._v("Jumpserver：web服务核心，django Luna：Web Terminal(本地开发jumpserver的话不需要这个模块) Coco：python写的ssh、websocket(较新的版本叫koko，go写的，本地开发jumpserver的话不需要这个模块) Guacamole：管理windows需要的模块(本地开发jumpserver的话不需要这个模块) Ansible API：管理资产 Jumpserver-Python-SDK：通过python代码直接调用api")])]),e._v(" "),a("h2",{attrs:{id:"python开发环境搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#python开发环境搭建"}},[e._v("#")]),e._v(" Python开发环境搭建")]),e._v(" "),a("ol",[a("li",[e._v("Python3安装：以下二选一\n"),a("ul",[a("li",[e._v("Anaconda3(推荐)："),a("a",{attrs:{href:"https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda2-5.2.0-MacOSX-x86_64.pkg",target:"_blank",rel:"noopener noreferrer"}},[e._v("点击下载"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("官方Python3："),a("a",{attrs:{href:"https://www.python.org/ftp/python/3.6.5/python-3.6.5-macosx10.9.pkg",target:"_blank",rel:"noopener noreferrer"}},[e._v("点击下载"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("PS：不建议使用3.7，推荐3.6.5")])])]),e._v(" "),a("li",[e._v("配置pip安装源为清华源：加速pip安装"),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pip -U\npip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])])]),e._v(" "),a("li",[e._v("安装虚拟环境管理工具：我习惯virtualenv，喜欢用pyenv的话自行安装并跳过这一步"),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('# 我第1步选择安装了Anaconda3，默认添加到了环境变量\n~ cat .bash_profile\nexport PATH="/anaconda3/bin:$PATH"\n# 此时我输入python、pip都是anaconda3的，覆盖了系统自带的python2和pip\n\n# 安装虚拟环境管理工具\npip install virtualenvwrapper # Unix\npip install virtualenvwrapper-win # Windows\n\n# 修改.bash_profile\nexport WORKON_HOME=~/.virtualenvs # 指定素有虚拟环境的存放目录，不配置的话默认就是~/.virtualenvs\nsource /anaconda3/bin/virtualenvwrapper.sh\n\n# virtualenvwrapper常用命令：\n创建虚拟环境：mkvirtualenv [虚拟环境名称]\n列出所有虚拟环境：lsvirtualenv或者workon\n进入/切换虚拟环境：workon [虚拟环境名称]\n进入当前环境的目录：cdvirtualenv\n删除虚拟环境：rmvirtualenv [虚拟环境名称]\n复制环境：cpvirtualenv env1 env3  # 复制env1到env3\nlssitepackages 列出当前环境中site-packages内容  （比pip list更详细）\ncdsitepackages 清除环境内所有第三方包\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br"),a("span",{staticClass:"line-number"},[e._v("10")]),a("br"),a("span",{staticClass:"line-number"},[e._v("11")]),a("br"),a("span",{staticClass:"line-number"},[e._v("12")]),a("br"),a("span",{staticClass:"line-number"},[e._v("13")]),a("br"),a("span",{staticClass:"line-number"},[e._v("14")]),a("br"),a("span",{staticClass:"line-number"},[e._v("15")]),a("br"),a("span",{staticClass:"line-number"},[e._v("16")]),a("br"),a("span",{staticClass:"line-number"},[e._v("17")]),a("br"),a("span",{staticClass:"line-number"},[e._v("18")]),a("br"),a("span",{staticClass:"line-number"},[e._v("19")]),a("br"),a("span",{staticClass:"line-number"},[e._v("20")]),a("br"),a("span",{staticClass:"line-number"},[e._v("21")]),a("br"),a("span",{staticClass:"line-number"},[e._v("22")]),a("br")])])])]),e._v(" "),a("h2",{attrs:{id:"安装mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql"}},[e._v("#")]),e._v(" 安装MySQL")]),e._v(" "),a("p",[e._v("本地的MySQL环境必须安装，因为pip依赖中有mysqlclient，必须要本地MySQL环境。"),a("br"),e._v("\n安装方式多选一：")]),e._v(" "),a("ul",[a("li",[e._v("清华镜像站下载地址：https://mirrors.tuna.tsinghua.edu.cn/mysql/downloads/MySQL-5.7/")]),e._v(" "),a("li",[e._v("brew安装："),a("code",[e._v("brew install mysql@5.7")]),e._v("，brew安装完之后需要建一个软连接，否则mysqlclient找不到"),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ln -s /usr/local/Cellar/mysql@5.7/5.7.26/bin/mysql_config /usr/local/bin/mysql_config\necho 'export PATH=\"/usr/local/opt/mysql@5.7/bin:$PATH\"' >> ~/.bash_profile\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])])])]),e._v(" "),a("p",[e._v("创建一个jumpserver用户和数据库备用：\n用户账号jumpserver密码123456、数据库名为jumpserver\n"),a("code",[e._v("mysql -uroot -e \"create database jumpserver default charset 'utf8'; grant all on jumpserver.* to 'jumpserver'@'127.0.0.1' identified by '123456'; flush privileges;\"")])]),e._v(" "),a("h2",{attrs:{id:"安装redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装redis"}},[e._v("#")]),e._v(" 安装redis")]),e._v(" "),a("p",[e._v("随意选择安装方式：docker、brew、源码安装")]),e._v(" "),a("h2",{attrs:{id:"配置本地启动jumpserver"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置本地启动jumpserver"}},[e._v("#")]),e._v(" 配置本地启动jumpserver")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("下载源码：")]),e._v(" "),a("ul",[a("li",[e._v("github：https://github.com/jumpserver/jumpserver.git")])])]),e._v(" "),a("li",[a("p",[e._v("创建一个python虚拟环境，并安装依赖")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mkvirtualenv jumpserver-venv -p /anaconda3/bin/python3 # virtualenvwrapper默认安装在python3环境的话，可以不用-p指定python3解释器\n# 注意!!!，虚拟环境名和项目目录名绝对不可以是jumpserver，会和app/jumpserver冲突导致启动不了项目\ncd jumpserver-master\npip install -r requirements/requirements.txt\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])])]),e._v(" "),a("li",[a("p",[e._v("用Pycharm或VS Code直接打开apps目录")]),e._v(" "),a("ul",[a("li",[e._v("Pycharm：打开后指定python环境为上面创建好的jumpserver环境")]),e._v(" "),a("li",[e._v("VS Code：打开后按下shift+command+P，输入select选择python解释器为虚拟环境的那个。然后点击vscode左侧的蜘蛛，配置项目debug")])])]),e._v(" "),a("li",[a("p",[e._v("复制配置文件并配置")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cd jumpserver-master\ncp config_example.yml config.yml\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('# vim config.yml\n# 这里随机秘钥的生成参考https://jumpserver.readthedocs.io/zh/master/dockerinstall.html，我是偷懒直接复制的官方Dockfile\nSECRET_KEY: kWQdmdCQKjaWlHYpPhkNQDkfaRulM6YnHctsHLlSPs8287o2kW\n...\nBOOTSTRAP_TOKEN: KXOeyNgDeTdpeu9q\n...\nDEBUG: true # 打开django的debug模式\n...\nDB_PASSWORD: "123456"\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br"),a("span",{staticClass:"line-number"},[e._v("7")]),a("br"),a("span",{staticClass:"line-number"},[e._v("8")]),a("br"),a("span",{staticClass:"line-number"},[e._v("9")]),a("br")])])]),e._v(" "),a("li",[a("p",[e._v("初始化数据库表")])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("cd jumpserver-master\ncd utils\nbash make_migrations.sh\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("ol",{attrs:{start:"6"}},[a("li",[e._v("现在就可以在Pycharm或VS Code中启动项目并访问了，默认账号密码就是admin，因为设置了debug为true，可以访问api文档http://127.0.0.1:8000/docs/")])]),e._v(" "),a("h2",{attrs:{id:"jumpserver开发文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jumpserver开发文档"}},[e._v("#")]),e._v(" jumpserver开发文档")]),e._v(" "),a("p",[e._v("官网的：http://docs.jumpserver.org/zh/docs/development.html")]),e._v(" "),a("ul",[a("li",[e._v("REST API规范约定：web开发通用规范，建议遵守")]),e._v(" "),a("li",[e._v("Jumpserver 项目规范(Draft)：Python开发通用规范，建议遵守")]),e._v(" "),a("li",[e._v("项目骨架：没什么用，很老的版本了，别看")]),e._v(" "),a("li",[e._v("API 文档：没什么用，直接去用"),a("a",{attrs:{href:"https://github.com/jumpserver/jumpserver-python-sdk",target:"_blank",rel:"noopener noreferrer"}},[e._v("jumpserver-python-sdk"),a("OutboundLink")],1)])]),e._v(" "),a("h2",{attrs:{id:"我觉得适合运维人员学习开发的资源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#我觉得适合运维人员学习开发的资源"}},[e._v("#")]),e._v(" 我觉得适合运维人员学习开发的资源")]),e._v(" "),a("ul",[a("li",[e._v("html、css："),a("a",{attrs:{href:"http://www.imooc.com/learn/9",target:"_blank",rel:"noopener noreferrer"}},[e._v("慕课网免费课程：初识HTML+CSS"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("Django："),a("a",{attrs:{href:"https://space.bilibili.com/252028233/",target:"_blank",rel:"noopener noreferrer"}},[e._v("对新手友好的Django2.0教程"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("Django REST framework："),a("a",{attrs:{href:"https://www.bilibili.com/video/av28871471",target:"_blank",rel:"noopener noreferrer"}},[e._v("django rest framework 实战和源码剖析"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);