(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{1012:function(s,a,n){"use strict";n.r(a);var t=n(12),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("马哥Linux教程-2019全新Linux用户和权限管理：https://www.bilibili.com/video/av33606103/\n我的评价：★★★★☆")])]),s._v(" "),t("p",[s._v("[TOC]\nLinux里，系统只认UID，不认用户名，id范围定义文件：/etc/login.defs")]),s._v(" "),t("h2",{attrs:{id:"介绍安全3a"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#介绍安全3a"}},[s._v("#")]),s._v(" 介绍安全3A")]),s._v(" "),t("p",[s._v("资源分派：")]),s._v(" "),t("ul",[t("li",[s._v("Authentication：认证")]),s._v(" "),t("li",[s._v("Authorization：授权")]),s._v(" "),t("li",[s._v("Accounting| Audition：审计")])]),s._v(" "),t("h2",{attrs:{id:"linux的用户user"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux的用户user"}},[s._v("#")]),s._v(" Linux的用户user")]),s._v(" "),t("ul",[t("li",[s._v("令牌token，identity：当一个用户登录系统时，会分配一个token")]),s._v(" "),t("li",[s._v("Linux用户：Username/UID")]),s._v(" "),t("li",[s._v("管理员：root，0")]),s._v(" "),t("li",[s._v("普通用户：1-65535\n"),t("ul",[t("li",[s._v("系统用户：1-499，1-999(CentOS7)\n对守护进程获取资源进行权限分配")]),s._v(" "),t("li",[s._v("登录用户：500+，1000+(CentOS7)\n交互式登录")])])])]),s._v(" "),t("h2",{attrs:{id:"linux的组group"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux的组group"}},[s._v("#")]),s._v(" Linux的组group")]),s._v(" "),t("ul",[t("li",[s._v("Linux组：Groupname/GID")]),s._v(" "),t("li",[s._v("管理员组：root，0")]),s._v(" "),t("li",[s._v("普通组：\n"),t("ul",[t("li",[s._v("系统组：1-499，1-999(CentOS7)")]),s._v(" "),t("li",[s._v("普通组：500+，1000+(CentOS7)")])])])]),s._v(" "),t("h2",{attrs:{id:"linux安全上下文"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux安全上下文"}},[s._v("#")]),s._v(" Linux安全上下文")]),s._v(" "),t("p",[s._v("运行中的程序：进程(Process)"),t("br"),s._v("\n以进程发起者的身份运行：")]),s._v(" "),t("ul",[t("li",[s._v("root：/bin/cat")]),s._v(" "),t("li",[s._v("mage：/bin/cat")])]),s._v(" "),t("p",[s._v("进程所能够访问资源的权限取决于进程的运行者的身份")]),s._v(" "),t("h2",{attrs:{id:"linux组的类别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux组的类别"}},[s._v("#")]),s._v(" Linux组的类别")]),s._v(" "),t("p",[s._v("用户的主要组(primary group)")]),s._v(" "),t("ul",[t("li",[s._v("用户必须属于一个且只有一个主组")]),s._v(" "),t("li",[s._v("组名同用户名，且仅包含一个用户，私有组")])]),s._v(" "),t("p",[s._v("用户的附加组(supplementary group)")]),s._v(" "),t("ul",[t("li",[s._v("一个用户可以属于零个或多个辅助组")])]),s._v(" "),t("h2",{attrs:{id:"用户和组的配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户和组的配置文件"}},[s._v("#")]),s._v(" 用户和组的配置文件")]),s._v(" "),t("p",[s._v("Linux用户和组的主要配置文件，不推荐直接编辑文件修改配置，都是通过一些命令行改")]),s._v(" "),t("ul",[t("li",[s._v("/etc/passwd：用户及其属性信息(名称、UID、主组ID等)")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("    1.这个文件里，每个用户信息各占一行，，格式为name:password:UID:GID:DECOS(描述信息):directory:shell类型\n        登录用户名\n        密码\n        用户身份编号\n        登录默认所在组编号\n        注释\n        用户主目录\n        用户默认使用的shell\n    2.直接修改这个文件里的UID，比如把x用户UID改成0，把root用户UID改成其他的，则管理员身份会变成x，root用户不再是管理员，因为Linux判断身份只看UID\n    3.如果一个系统没有UID为0的用户，重启时会卡住无法进入系统，但是有办法修复(百度一下得了)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("ul",[t("li",[s._v("/etc/group：组及其属性信息")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("文件格式：\n    1.群组名称\n    2.群组密码：通常不需要设定，密码是被记录在/etc/gshadow\n    3.GID：组id\n    4.以当前组为附加组的用户列表(逗号分隔)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ul",[t("li",[s._v("/etc/shadow：用户密码及其相关属性")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("    1.每行有9个属性\n        login name：登录用户名\n        encrypted password：用户密码 # 加密的口令，一般就是md5和sha，可以用命令修改：authconfig --passalgo=sha256 --update\n        date of last password change # 显示距离1970年1月1日的天数，如果为0，则下次登录时会提示用户改密码\n        minimum password age：密码再过几天可以被修改\n        maximum password age：密码过期前几天必须被修改(99999表示永不过期)\n        password warning period：密码过期前几天提醒用户，默认7天\n        password inactivity period：密码过期几天后账号会被锁定\n        account expiration date：1970年1月1日起，多少天后账号失效\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("ul",[t("li",[s._v("/etc/gshadow：组密码及其相关属性")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("1.组名\n2.加密密码\n3.管理员\n4.成员\n\n给组设置密码：gpasswd mage\n组密码的作用：一个用户不在一个某个组里，想要将这个组变成自己的主组，可以：newgrp {组名}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"shell"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#shell"}},[s._v("#")]),s._v(" shell")]),s._v(" "),t("p",[s._v("查看系统支持的shell："),t("code",[s._v("cat /etc/shells")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/bin/sh\n/bin/bash\n/sbin/nologin    # 设置用户shell类型为这个，意思就是不可以登录系统，一般是给一些服务用的\n/bin/dash\n/bin/tcsh\n/bin/csh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("查看当前的shell类型："),t("code",[s._v("echo $SHELL")])]),s._v(" "),t("h2",{attrs:{id:"密码的复杂性策略"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#密码的复杂性策略"}},[s._v("#")]),s._v(" 密码的复杂性策略")]),s._v(" "),t("ul",[t("li",[s._v("使用数组、大写字母、小写字母及特殊字符中至少3种")]),s._v(" "),t("li",[s._v("足够长")]),s._v(" "),t("li",[s._v("使用随机密码")]),s._v(" "),t("li",[s._v("定期更换，不要使用最近曾经使用过的密码")])]),s._v(" "),t("h2",{attrs:{id:"用户和组管理命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户和组管理命令"}},[s._v("#")]),s._v(" 用户和组管理命令")]),s._v(" "),t("ul",[t("li",[s._v("用户管理命令\n"),t("ul",[t("li",[s._v("useradd = adduser # 软连接关系")]),s._v(" "),t("li",[s._v("usermod")]),s._v(" "),t("li",[s._v("userdel")])])]),s._v(" "),t("li",[s._v("组账号维护命令\n"),t("ul",[t("li",[s._v("groupadd")]),s._v(" "),t("li",[s._v("groupmod")]),s._v(" "),t("li",[s._v("groupdel")])])])]),s._v(" "),t("div",{attrs:{align:"center"}},[t("img",{attrs:{width:"640",src:n(874)}})]),s._v(" "),t("p",[s._v("-u指定的uid可以突破65535上限，id递增策略和数据库自增id主键策略相同，但是会在设置的范围内选择。\n-o参数可以创建两个相同UID的用户，但是这就破坏了UID的唯一性")]),s._v(" "),t("p",[s._v("查看创建用户后的默认设置："),t("code",[s._v("cat /etc/default/useradd")]),s._v("或者"),t("code",[s._v("useradd -D")]),s._v("\n修改默认设置：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("useradd -D -s SHELL\nuseradd -D -b BASE_DIR\nuseradd -D -g GROUP\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"练习"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#练习"}},[s._v("#")]),s._v(" 练习")]),s._v(" "),t("ol",[t("li",[s._v('创建用户gentoo，附加组为bin和root，默认shell为/bin/csh，注释信息为"Gentoo Distribution"')])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('useradd -c "Gentoo Distribution" -G bin,root -s /bin/csh gentoo\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("创建下面的用户、组合和组成员关系")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("1. 创建webs组\ngroupadd webs\n# 查看组是否生成：getent group 或 cat /etc/group\n2. 用户nginx、varnish使用webs作为附属组\nuseradd nginx -G webs\nuseradd varnish -G webs\n3. 用户mysql，不可交互登录系统，且不是webs的成员，nginx，varnish，mysql密码都是magedu\nuseradd mysql -s /sbin/nologin\npasswd mysql # 这里设置密码magedu\n# 快捷设置密码\necho magedu | passwd --stdin nginx\necho magedu | passwd --stdin varnish\necho magedu | passwd --stdin mysql\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h2",{attrs:{id:"新建用户的相关文件和命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新建用户的相关文件和命令"}},[s._v("#")]),s._v(" 新建用户的相关文件和命令")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("/etc/default/useradd\n/etc/skel/*\n/etc/login.defs\nnewusers {passwd格式文件} # 批量创建用户\nchpasswd 批量修改用户密码：\n    vim pwd.txt\n        user1:123456\n        user2:abcdef\n    cat pwd.txt | chpasswd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("div",{attrs:{align:"center"}},[t("img",{attrs:{width:"640",src:n(875)}})]),s._v(" "),t("h2",{attrs:{id:"查看用户相关的id信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看用户相关的id信息"}},[s._v("#")]),s._v(" 查看用户相关的id信息")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("id [OPTION]... [USER]\n    -u：显示UID\n    -g：显示GID\n    -G：显示用户所属的组的ID\n    -n：显示名称，需配合ugG使用\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{attrs:{align:"center"}},[t("img",{attrs:{width:"640",src:n(876)}})]),s._v("\n退回原来的身份：exit 或者 logout\n"),t("div",{attrs:{align:"center"}},[t("img",{attrs:{width:"640",src:n(877)}})]),s._v(" "),t("div",{attrs:{align:"center"}},[t("img",{attrs:{width:"640",src:n(878)}})]),s._v(" "),t("div",{attrs:{align:"center"}},[t("img",{attrs:{width:"640",src:n(879)}})]),s._v(" "),t("div",{attrs:{align:"center"}},[t("img",{attrs:{width:"640",src:n(880)}})]),s._v("\n删除组时，该组不能是某个user的主组(因为user必须有一个主组)\n"),t("div",{attrs:{align:"center"}},[t("img",{attrs:{width:"640",src:n(881)}})]),s._v(" "),t("div",{attrs:{align:"center"}},[t("img",{attrs:{width:"640",src:n(882)}})])])}),[],!1,null,null,null);a.default=e.exports},874:function(s,a,n){s.exports=n.p+"assets/img/useradd.88f338cb.jpg"},875:function(s,a,n){s.exports=n.p+"assets/img/usermod-用户属性修改.c7150046.jpg"},876:function(s,a,n){s.exports=n.p+"assets/img/切换用户su(switch_user).f7655787.jpg"},877:function(s,a,n){s.exports=n.p+"assets/img/设置密码.1a32535f.jpg"},878:function(s,a,n){s.exports=n.p+"assets/img/修改用户密码策略.46d1a242.jpg"},879:function(s,a,n){s.exports=n.p+"assets/img/创建组.eac1e6b2.jpg"},880:function(s,a,n){s.exports=n.p+"assets/img/修改和删除组.70d9d508.jpg"},881:function(s,a,n){s.exports=n.p+"assets/img/更改组密码.46e2bb95.jpg"},882:function(s,a,n){s.exports=n.p+"assets/img/更改和查看组成员.ade88e31.jpg"}}]);