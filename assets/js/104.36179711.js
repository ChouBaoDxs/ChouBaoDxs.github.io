(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{1005:function(e,r,n){"use strict";n.r(r);var a=n(12),t=Object(a.a)({},(function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"title"}),n("p",[e._v("视频名称：使用Rancher 2.0 创建Kubernetes集群"),n("br"),e._v("\n视频地址：https://www.bilibili.com/video/av53783808"),n("br"),e._v("\nUP主：Rancher_Labs——https://space.bilibili.com/430496045"),n("br"),e._v("\nrancher官方文档：https://rancher.com/docs/rancher/v2.x/zh/"),n("br"),e._v("\n我的评价：★★★★☆")])]),e._v(" "),n("p",[e._v("[TOC]")]),e._v(" "),n("h2",{attrs:{id:"_1-how-to-install-a-rancher-envirmonment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-how-to-install-a-rancher-envirmonment"}},[e._v("#")]),e._v(" 1. How to install a Rancher envirmonment")]),e._v(" "),n("p",[e._v("rancher1.x分为server和agent, 2.x起合并为一个。下面是通过docker简单启动一个rancher的命令：")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("docker run -d -p 80:80 -p 443:443 rancher/rancher:v2.0.0\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("浏览器访问rancher：192.168.1.7(本机ip，我这里是局域网内ip)，首次访问需要设置密码和url(会自动从地址栏读取，可以在设置里修改)，我这里密码先简单设置为123456，url就默认")]),e._v(" "),n("p",[e._v("进入rancher页面后，设置里需要注意的设置项：")]),e._v(" "),n("ul",[n("li",[e._v("语言可以修改为简体中文")]),e._v(" "),n("li",[e._v("system-default-registry：私有镜像仓库设置")])]),e._v(" "),n("h2",{attrs:{id:"_2-how-to-use-rancher-to-import-a-current-kubernetes-cluster"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-how-to-use-rancher-to-import-a-current-kubernetes-cluster"}},[e._v("#")]),e._v(" 2. How to use Rancher to import a current Kubernetes cluster")]),e._v(" "),n("p",[e._v("添加一个现有的k8s集群到rancher中：导航栏中选择"),n("code",[e._v("集群")]),e._v("——>添加集群——>import——>将页面给出的kubectl命令复制到k8s的机器上执行——>等到所有服务都启动，就可以在rancher的集群面板中看到import的k8s集群")]),e._v(" "),n("p",[e._v("简单使用import进来的k8s：")]),e._v(" "),n("ol",[n("li",[e._v("在Workloads里创建一个nginx服务，名字就叫test")]),e._v(" "),n("li",[e._v("在Load Balancing里创建一个ingress,名字就叫test，规则里配置一条")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("Path：/index.html\nTarget：test\nPort：80\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[e._v("访问一下")])]),e._v(" "),n("h2",{attrs:{id:"_3-how-to-use-rancher-to-create-a-custom-kubernetes-cluster"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-how-to-use-rancher-to-create-a-custom-kubernetes-cluster"}},[e._v("#")]),e._v(" 3. How to use Rancher to create a custom Kubernetes cluster")]),e._v(" "),n("p",[e._v("创建一个自定义k8s集群：导航栏中选择"),n("code",[e._v("集群")]),e._v("——>添加集群——>custom——>填写一下集群名称，选择k8s版本(这些k8s镜像都是经过rancher封装的，可以很方便地拉取和使用)，选择网络插件(这里跟随讲师选择Flannel)，其他都默认即可——>点击next后，在"),n("code",[e._v("节点角色")]),e._v("中勾选etcd、control、worker，还可以自己指定node ip、标签等。"),n("code",[e._v("注意，如果是VPC网络，Node Address一定要填写好公私网ip")]),e._v("——>复制生成的命令，到准备好的几台(讲师准备了三台)机器上执行，等一会初始化完成即可使用。")]),e._v(" "),n("h2",{attrs:{id:"_4-how-to-use-rancher-to-create-a-kubernetes-cluster-with-aliyun-docker-machine-driver"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-how-to-use-rancher-to-create-a-kubernetes-cluster-with-aliyun-docker-machine-driver"}},[e._v("#")]),e._v(" 4. How to use Rancher to create a Kubernetes cluster with Aliyun docker machine driver")]),e._v(" "),n("p",[e._v("讲师在添加集群的界面中可以选择"),n("code",[e._v("Aliyun ECS")]),e._v("，我这里没有，原因是讲师已经配置了阿里云的Node Drivers：")]),e._v(" "),n("ol",[n("li",[e._v("导航栏选择"),n("code",[e._v("Node Drivers")])]),e._v(" "),n("li",[e._v("右侧点击"),n("code",[e._v("添加主机驱动")])]),e._v(" "),n("li",[e._v("填写下载url和域名白名单：")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("下载url：http://machine-driver.oss-cn-shanghai.aliyuncs.com/aliyun/1.0.1/linux/amd64/docker-machine-driver-aliyunecs.tgz\n域名白名单：ecs.aliyun.com\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("此时就可以在创建集群页面中选择"),n("code",[e._v("Aliyun ECS")]),e._v("了，此时会比之前import和custom多一个Node Pools设置——>点击Add Node Template——>在弹出的对话框中填写阿里云账号的Access Key和Secret——>然后就可以选择机器配置了，选择好机器配置后保存template——>由于是演示，这里就用一台机子搞事情，Node Pools里选择刚新建的template，勾选etcd、control、worker，Name Prefix就简单写"),n("code",[e._v("aliyun-")]),e._v("。——>点击create集群(此时会根据template当场买一台机器，然后开始跑脚本初始化集群)")]),e._v(" "),n("h2",{attrs:{id:"_5-qa"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-qa"}},[e._v("#")]),e._v(" 5. QA")]),e._v(" "),n("ol",[n("li",[e._v("rancher启动时80和443端口是否可修改？\n答：可以，rancher的docker启动参数"),n("code",[e._v("--http-listen-port")]),e._v("、"),n("code",[e._v("--https-listen-port")]),e._v("可以指定rancher服务监听的端口")]),e._v(" "),n("li",[e._v("centos7.2，因为ssh的缘故无法实现rancher ha部署，请问有比较好的解决办法吗？另外有rancher ha的部署教程吗。\n答：暂时没有办法。rancher ha的部署教程看去看rancher的官方文档。")]),e._v(" "),n("li",[e._v("rancher没有集群的话，挂掉后对pod有影响吗？\n答：没有影响。")]),e._v(" "),n("li",[e._v("ingress-nginx是怎么配置的，ingress的作用是啥？\n答：ingress是k8s内部的一个负载均衡规则设置。")]),e._v(" "),n("li",[e._v("k8s的原始组件镜像可以选择吗？\n答：不可以也不推荐修改，直接用rancher打包过的。")]),e._v(" "),n("li",[e._v("rancher创建k8s时三种网络插件的区别。\n答：可以去k8s了解一下。")]),e._v(" "),n("li",[e._v("rancher支持腾讯云吗？\n答：暂时不支持。主要是k8s版本问题以及没有腾讯云的driver。")]),e._v(" "),n("li",[e._v("目前有Azure的driver吗？\n答：有的")]),e._v(" "),n("li",[e._v("rancher2推荐的操作系统短期内会支持ubuntu-18.04吗？\n答：只要是docker能安装的都支持")]),e._v(" "),n("li",[e._v("添加custom，可以直接开始部署3个节点的高可用master吗？\n答：可以")]),e._v(" "),n("li",[e._v("阿里云driver的下载地址？\n答：最新版的rancher已经有了，激活一下即可。")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("http://machine-driver.oss-cn-shanghai.aliyuncs.com/aliyun/1.0.1/linux/amd64/docker-machine-driver-aliyunecs.tgz\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("ol",{attrs:{start:"12"}},[n("li",[e._v("RKE部署Rancher高可用对应的证书能讲一下吗？\n答：推荐一下腾讯云上的免费证书")]),e._v(" "),n("li",[e._v("rancher可以离线安装吗？\n答：可以")]),e._v(" "),n("li",[e._v("能在vSphere上面创建集群吗？如果vSphere上面的虚拟机无法自动分配IP，从rancher上面创建集群的时候IP如何解决？\n答：无法创建，因为无法自动分配ip的画，rancher就无法连接上机器")]),e._v(" "),n("li",[e._v("现在还可以自建商店吗？能接入自己的harbor吗？\n答：自建商店最近版本会出来。harbor就是个私有镜像仓库，已经有的了。")]),e._v(" "),n("li",[e._v("公司没有人会k8s，可以不部署k8s，直接管理docker吗？\n答：rancher2.x不可以，请使用rancher1.6。")]),e._v(" "),n("li",[e._v("rancher部署出来的k8s集群有web界面吗？\n答：后面会有专门的培训章节讲这个")]),e._v(" "),n("li",[e._v("rancher支持自己建立helm仓库？除了github\n答：支持")]),e._v(" "),n("li",[e._v("RKE安装rancher高可用时，不指定证书的base64，可以正常用吗？\n答：可以，但是要把secret和rancher部署deployment挂载的secret相关的都去掉。")]),e._v(" "),n("li",[e._v("rancher创建的k8s没有master这个概念吗？\n答：我们叫做control panel，相当于master")]),e._v(" "),n("li",[e._v("cluster中的vsphere模板在哪修改？\n答：鼠标移到rancher界面里右上角头像，会有一个下拉菜单，可以看到Node Template")]),e._v(" "),n("li",[e._v("想做下import k8s cluster，有没有现成的手动k8s bare-mental的文档\n答：刚刚视频里有演示怎么import集群，按那个步骤走即可")]),e._v(" "),n("li",[e._v("rancher创建阿里云k8s集群，按量付费创建ecs，大概什么价钱？\n答：和你在阿里云上手动买一样的价钱")]),e._v(" "),n("li",[e._v("custom方式创建k8s，可以直接创建3个master节点的高可用k8s吗\n答：可以")]),e._v(" "),n("li",[e._v("custom安装的node上kubectl怎么安装？\n答：node其实不需要安装kubectl，rancher的cluster管理界面里有kubectl按钮，复制下来就可以直接用了。")]),e._v(" "),n("li",[e._v("怎么对集群和应用做备份？\n答：应用数据备份需要自己考虑。集群的话之后的版本会出一个export cluster的功能。")]),e._v(" "),n("li",[e._v("刚刚说单节点rancher挂了，不影响k8s，rancher重新搭建后，可以import吗？\n答：如果只是rancher容器停止了，起来就好了。如果是rancher容器被删除，同时没有对数据卷进行备份，那么就要自己重新import了。")]),e._v(" "),n("li",[e._v("rancher后期会有像openstack一样有中文界面吗？\n答：快翻译完了。")]),e._v(" "),n("li",[e._v("2.0之后，k8s管理界面使用原生的还是rancher的管理界面？\n答：就是用rancher去管理k8s")]),e._v(" "),n("li",[e._v("阿里云的access key怎么弄？\n答：阿里云登录控制台，右上角头像下拉框里有。")]),e._v(" "),n("li",[e._v("rancher是单节点就能用吗？\n答：可以的")]),e._v(" "),n("li",[e._v("etcd、worker、control可不可以分开部署？\n答：可以")]),e._v(" "),n("li",[e._v("rancher自带的证书有没有有效期？\n答：自带证书会自动更新有效期")]),e._v(" "),n("li",[e._v("gitlab-ci与rancher的集成\n答：不确定，和gitlab是有集成")]),e._v(" "),n("li",[e._v("storage的3种access mode区分和应用场景\n答：后面弄一个大专题来讲吧")]),e._v(" "),n("li",[e._v("xip.io 强依赖？有其他选项？\n答：xip.io是个比较方便的DNS解析，可以省心地使用域名到ip的功能")]),e._v(" "),n("li",[e._v("pipeline中什么时候能选择gitlab？\n答：下个版本吧")]),e._v(" "),n("li",[e._v("怎么update服务\n答：服务右侧直接有update按钮")]),e._v(" "),n("li",[e._v("rancher以custom模式创建的k8s集群，会设置默认k8s对主机资源保留吗？\n答：不会")]),e._v(" "),n("li",[e._v("阿里云slb什么时候讲？\n答：不在课程范围内")]),e._v(" "),n("li",[e._v("rancher高可用，centos7.2要什么ssh版本\n答：openssh7.0以上")]),e._v(" "),n("li",[e._v("不限制集群pod数的话，可能会把集群搞崩溃的\n答：后续版本会考虑加的")]),e._v(" "),n("li",[e._v("job的镜像更新必须先删除再deploy吗？\n答：是的，因为job就跑一次")]),e._v(" "),n("li",[e._v("custom安装k8s，如何修改flannel默认网段\n答：暂时不支持修改")]),e._v(" "),n("li",[e._v("rancher数据存储在etcd里面吗？搞可用也是通过etcd集群提供的功能保证？\n答：对")])]),e._v(" "),n("p",[e._v("这里开始讲rancher的商业模式：产品免费开源，提供商业订阅制的付费技术支持")])])}),[],!1,null,null,null);r.default=t.exports}}]);